import{f as U,a as P,d as Nt,c as Ye,t as ua}from"../chunks/Ca04Kkn5.js";import"../chunks/CF_acvv4.js";import{o as st}from"../chunks/BlBDq6ob.js";import{B as kt,n as be,v as ma,q as Qt,o as fa,J as ha,g as e,X as pa,L as ga,M as ba,N as jt,O as Vt,z as at,a8 as ya,ax as _a,G as Mt,I as Ia,aE as bt,aF as yt,C as qe,aG as Jt,av as Zt,aH as ea,aA as Ta,a6 as Gt,af as Bt,D as ta,F as wa,aI as At,R as aa,E as na,aJ as ka,aK as Va,ar as Aa,aL as Ca,au as xa,aM as Ea,x as Sa,an as Ma,aN as qa,aO as Da,aP as zt,P as La,aQ as ra,aR as Ra,aS as Na,aT as za,aU as Pa,aV as Fa,aC as ja,b as ia,Q as sa,p as ye,Y as Ve,k as s,m as i,ag as me,aB as W,Z as S,j as _e,aD as Y,t as ee,i as De,s as f,a as fe}from"../chunks/Wv6JicDl.js";import{i as Ga}from"../chunks/CDhxchT2.js";import{d as $e,e as pt,s as G}from"../chunks/DdsAbmA8.js";import{p as B,b as rt,i as se}from"../chunks/CI2neQpF.js";function Le(n,a){return a}function Ba(n,a,t){for(var r=n.items,d=[],c=a.length,o=0;o<c;o++)Ca(a[o].e,d,!0);var u=c>0&&d.length===0&&t!==null;if(u){var v=t.parentNode;xa(v),v.append(t),r.clear(),Se(n,a[0].prev,a[c-1].next)}Ea(d,()=>{for(var m=0;m<c;m++){var b=a[m];u||(r.delete(b.k),Se(n,b.prev,b.next)),na(b.e,!u)}})}function xe(n,a,t,r,d,c=null){var o=n,u={flags:a,items:new Map,first:null},v=(a&Jt)!==0;if(v){var m=n;o=be?kt(ma(m)):m.appendChild(Qt())}be&&fa();var b=null,V=!1,A=new Map,E=pa(()=>{var w=t();return ea(w)?w:w==null?[]:Zt(w)}),y,h;function p(){Ua(h,y,u,A,o,d,a,r,t),c!==null&&(y.length===0?b?ta(b):b=Mt(()=>c(o)):b!==null&&wa(b,()=>{b=null}))}ha(()=>{h??(h=Sa),y=e(E);var w=y.length;if(V&&w===0)return;V=w===0;let C=!1;if(be){var _=ga(o)===ba;_!==(w===0)&&(o=jt(),kt(o),Vt(!1),C=!0)}if(be){for(var l=null,T,g=0;g<w;g++){if(at.nodeType===ya&&at.data===_a){o=at,C=!0,Vt(!1);break}var I=y[g],M=r(I,g);T=qt(at,u,l,null,I,M,g,d,a,t),u.items.set(M,T),l=T}w>0&&kt(jt())}if(be)w===0&&c&&(b=Mt(()=>c(o)));else if(Ia()){var R=new Set,x=qe;for(g=0;g<w;g+=1){I=y[g],M=r(I,g);var D=u.items.get(M)??A.get(M);D?a&(bt|yt)&&oa(D,I,g,a):(T=qt(null,u,null,null,I,M,g,d,a,t,!0),A.set(M,T)),R.add(M)}for(const[L,H]of u.items)R.has(L)||x.skipped_effects.add(H.e);x.oncommit(p)}else p();C&&Vt(!0),e(E)}),be&&(o=at)}function Ua(n,a,t,r,d,c,o,u,v){var m=(o&Va)!==0,b=(o&(bt|yt))!==0,V=a.length,A=t.items,E=t.first,y=E,h,p=null,w,C=[],_=[],l,T,g,I;if(m)for(I=0;I<V;I+=1)l=a[I],T=u(l,I),g=A.get(T),g!==void 0&&(g.a?.measure(),(w??(w=new Set)).add(g));for(I=0;I<V;I+=1){if(l=a[I],T=u(l,I),g=A.get(T),g===void 0){var M=r.get(T);if(M!==void 0){r.delete(T),A.set(T,M);var R=p?p.next:y;Se(t,p,M),Se(t,M,R),Ct(M,R,d),p=M}else{var x=y?y.e.nodes_start:d;p=qt(x,t,p,p===null?t.first:p.next,l,T,I,c,o,v)}A.set(T,p),C=[],_=[],y=p.next;continue}if(b&&oa(g,l,I,o),g.e.f&At&&(ta(g.e),m&&(g.a?.unfix(),(w??(w=new Set)).delete(g))),g!==y){if(h!==void 0&&h.has(g)){if(C.length<_.length){var D=_[0],L;p=D.prev;var H=C[0],z=C[C.length-1];for(L=0;L<C.length;L+=1)Ct(C[L],D,d);for(L=0;L<_.length;L+=1)h.delete(_[L]);Se(t,H.prev,z.next),Se(t,p,H),Se(t,z,D),y=D,p=z,I-=1,C=[],_=[]}else h.delete(g),Ct(g,y,d),Se(t,g.prev,g.next),Se(t,g,p===null?t.first:p.next),Se(t,p,g),p=g;continue}for(C=[],_=[];y!==null&&y.k!==T;)y.e.f&At||(h??(h=new Set)).add(y),_.push(y),y=y.next;if(y===null)continue;g=y}C.push(g),p=g,y=g.next}if(y!==null||h!==void 0){for(var F=h===void 0?[]:Zt(h);y!==null;)y.e.f&At||F.push(y),y=y.next;var j=F.length;if(j>0){var K=o&Jt&&V===0?d:null;if(m){for(I=0;I<j;I+=1)F[I].a?.measure();for(I=0;I<j;I+=1)F[I].a?.fix()}Ba(t,F,K)}}m&&aa(()=>{if(w!==void 0)for(g of w)g.a?.apply()}),n.first=t.first&&t.first.e,n.last=p&&p.e;for(var q of r.values())na(q.e);r.clear()}function oa(n,a,t,r){r&bt&&Bt(n.v,a),r&yt?Bt(n.i,t):n.i=t}function qt(n,a,t,r,d,c,o,u,v,m,b){var V=(v&bt)!==0,A=(v&ka)===0,E=V?A?Ta(d,!1,!1):Gt(d):d,y=v&yt?Gt(o):o,h={i:y,v:E,k:c,a:null,e:null,prev:t,next:r};try{if(n===null){var p=document.createDocumentFragment();p.append(n=Qt())}return h.e=Mt(()=>u(n,E,y,m),be),h.e.prev=t&&t.e,h.e.next=r&&r.e,t===null?b||(a.first=h):(t.next=h,t.e.next=h.e),r!==null&&(r.prev=h,r.e.prev=h.e),h}finally{}}function Ct(n,a,t){for(var r=n.next?n.next.e.nodes_start:t,d=a?a.e.nodes_start:t,c=n.e.nodes_start;c!==null&&c!==r;){var o=Aa(c);d.before(c),c=o}}function Se(n,a,t){a===null?n.first=t:(a.next=t,a.e.next=t&&t.e),t!==null&&(t.prev=a,t.e.prev=a&&a.e)}const Ut=[...` 	
\r\fÂ \v\uFEFF`];function Oa(n,a,t){var r=n==null?"":""+n;if(a&&(r=r?r+" "+a:a),t){for(var d in t)if(t[d])r=r?r+" "+d:d;else if(r.length)for(var c=d.length,o=0;(o=r.indexOf(d,o))>=0;){var u=o+c;(o===0||Ut.includes(r[o-1]))&&(u===r.length||Ut.includes(r[u]))?r=(o===0?"":r.substring(0,o))+r.substring(u+1):o=u}}return r===""?null:r}function Ha(n,a){return n==null?null:String(n)}function Ie(n,a,t,r,d,c){var o=n.__className;if(be||o!==t||o===void 0){var u=Oa(t,r,c);(!be||u!==n.getAttribute("class"))&&(u==null?n.removeAttribute("class"):n.className=u),n.__className=t}else if(c&&d!==c)for(var v in c){var m=!!c[v];(d==null||m!==!!d[v])&&n.classList.toggle(v,m)}return c}function Dt(n,a,t,r){var d=n.__style;if(be||d!==a){var c=Ha(a);(!be||c!==n.getAttribute("style"))&&(c==null?n.removeAttribute("style"):n.style.cssText=c),n.__style=a}return r}function gt(n,a,t=!1){if(n.multiple){if(a==null)return;if(!ea(a))return qa();for(var r of n.options)r.selected=a.includes(nt(r));return}for(r of n.options){var d=nt(r);if(Da(d,a)){r.selected=!0;return}}(!t||a!==void 0)&&(n.selectedIndex=-1)}function Lt(n){var a=new MutationObserver(()=>{gt(n,n.__value)});a.observe(n,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Ma(()=>{a.disconnect()})}function $a(n,a,t=a){var r=new WeakSet,d=!0;zt(n,"change",c=>{var o=c?"[selected]":":checked",u;if(n.multiple)u=[].map.call(n.querySelectorAll(o),nt);else{var v=n.querySelector(o)??n.querySelector("option:not([disabled])");u=v&&nt(v)}t(u),qe!==null&&r.add(qe)}),La(()=>{var c=a();if(n===document.activeElement){var o=ra??qe;if(r.has(o))return}if(gt(n,c,d),d&&c===void 0){var u=n.querySelector(":checked");u!==null&&(c=nt(u),t(c))}n.__value=c,d=!1}),Lt(n)}function nt(n){return"__value"in n?n.__value:n.value}const Wa=Symbol("is custom element"),Ya=Symbol("is html");function ft(n){if(be){var a=!1,t=()=>{if(!a){if(a=!0,n.hasAttribute("value")){var r=n.value;X(n,"value",null),n.value=r}if(n.hasAttribute("checked")){var d=n.checked;X(n,"checked",null),n.checked=d}}};n.__on_r=t,aa(t),Fa()}}function Ka(n,a){var t=la(n);t.value===(t.value=a??void 0)||n.value===a&&(a!==0||n.nodeName!=="PROGRESS")||(n.value=a??"")}function X(n,a,t,r){var d=la(n);be&&(d[a]=n.getAttribute(a),a==="src"||a==="srcset"||a==="href"&&n.nodeName==="LINK")||d[a]!==(d[a]=t)&&(a==="loading"&&(n[Pa]=t),t==null?n.removeAttribute(a):typeof t!="string"&&Xa(n).includes(a)?n[a]=t:n.setAttribute(a,t))}function la(n){return n.__attributes??(n.__attributes={[Wa]:n.nodeName.includes("-"),[Ya]:n.namespaceURI===Ra})}var Ot=new Map;function Xa(n){var a=n.getAttribute("is")||n.nodeName,t=Ot.get(a);if(t)return t;Ot.set(a,t=[]);for(var r,d=n,c=Element.prototype;c!==d;){r=za(d);for(var o in r)r[o].set&&t.push(o);d=Na(d)}return t}function Ht(n,a,t=a){var r=new WeakSet;zt(n,"input",async d=>{var c=d?n.defaultValue:n.value;if(c=xt(n)?Et(c):c,t(c),qe!==null&&r.add(qe),await ja(),c!==(c=a())){var o=n.selectionStart,u=n.selectionEnd,v=n.value.length;if(n.value=c??"",u!==null){var m=n.value.length;o===u&&u===v&&m>v?(n.selectionStart=m,n.selectionEnd=m):(n.selectionStart=o,n.selectionEnd=Math.min(u,m))}}}),(be&&n.defaultValue!==n.value||ia(a)==null&&n.value)&&(t(xt(n)?Et(n.value):n.value),qe!==null&&r.add(qe)),sa(()=>{var d=a();if(n===document.activeElement){var c=ra??qe;if(r.has(c))return}xt(n)&&d===Et(n.value)||n.type==="date"&&!d&&!n.value||d!==n.value&&(n.value=d??"")})}function Qa(n,a,t=a){zt(n,"change",r=>{var d=r?n.defaultChecked:n.checked;t(d)}),(be&&n.defaultChecked!==n.checked||ia(a)==null)&&t(n.checked),sa(()=>{var r=a();n.checked=!!r})}function xt(n){var a=n.type;return a==="number"||a==="range"}function Et(n){return n===""?null:+n}let St=null;function He(){if(!St){const n=typeof window<"u"&&(window.AudioContext||window.webkitAudioContext)||globalThis.AudioContext||globalThis.webkitAudioContext;if(!n)throw new Error("AudioContext is not available in this environment");St=new n}return St}async function Ja(){const n=He();if(n.state==="suspended"){const a=n.createBuffer(1,1,8e3),t=n.createBufferSource();t.buffer=a,t.connect(n.destination),t.start(0);try{await n.resume(),console.log("âœ“ AudioContext unlocked")}catch(r){console.error("Failed to unlock AudioContext:",r)}}}const Za=[0,15,-20],en=.05,tn=.2,an=.6,nn=1,$t=.05,rn=.01,dt=20,ut=2e4;function sn(n={}){const a=He(),{frequency:t=440,velocity:r=100,attackTime:d=en,decayTime:c=tn,sustainLevel:o=an,releaseTime:u=nn,detuneCents:v=Za,velocityScale:m=.3}=n;if(t<dt||t>ut)throw new Error(`Frequency out of range: ${t} Hz. Valid range: ${dt}-${ut} Hz`);if(r<0||r>127)throw new Error(`Velocity out of range: ${r}. Valid range: 0-127`);if(d<0||c<0||u<0)throw new Error("Attack, decay, and release times must be non-negative");if(o<0||o>1)throw new Error("Sustain level must be between 0 and 1");const b=v.map(_=>{const l=a.createOscillator();return l.type="sine",l.frequency.value=t,l.detune.value=_,l}),V=a.createGain();V.gain.value=0;const A=a.createGain(),E=r/127;A.gain.value=E*m;let y=!1,h=t,p=r,w=[...v];b.forEach(_=>_.connect(V)),V.connect(A);function C(_,l,T,g){if(_<0||l<0||g<0)throw new Error("Envelope times must be non-negative");if(T<0||T>1)throw new Error("Sustain level must be between 0 and 1")}return{oscillators:b,envelope:V,velocityGain:A,getIsPlaying(){return y},getFrequency(){return h},getVelocity(){return p},getDetuning(){return[...w]},noteOn(){y&&this.noteOff();const _=a.currentTime;return y=!0,b.forEach(l=>l.start(_)),V.gain.setValueAtTime(0,_),V.gain.linearRampToValueAtTime(1,_+d),V.gain.linearRampToValueAtTime(o,_+d+c),this},noteOff(){const _=a.currentTime;return y=!1,V.gain.setValueAtTime(V.gain.value,_),V.gain.linearRampToValueAtTime(0,_+u),b.forEach(l=>l.stop(_+u)),this},connect(_){return A.connect(_),this},disconnect(){return A.disconnect(),this},setFrequency(_){if(_<dt||_>ut)throw new Error(`Frequency out of range: ${_} Hz. Valid range: ${dt}-${ut} Hz`);h=_;const l=a.currentTime;return b.forEach(T=>{T.frequency.linearRampToValueAtTime(_,l+$t)}),this},setVelocity(_){if(_<0||_>127)throw new Error(`Velocity out of range: ${_}. Valid range: 0-127`);p=_;const l=a.currentTime,T=_/127;return A.gain.linearRampToValueAtTime(T*m,l+rn),this},setDetuning(_){if(_.length!==b.length)throw new Error(`Detuning array length (${_.length}) must match oscillator count (${b.length})`);w=[..._];const l=a.currentTime;return b.forEach((T,g)=>{T.detune.linearRampToValueAtTime(_[g],l+$t)}),this},setEnvelope(_){const{attackTime:l,decayTime:T,sustainLevel:g,releaseTime:I}=_;return C(l,T,g,I),this},getState(){return{isPlaying:y,frequency:h,velocity:p,detuning:[...w],envelopePhase:y?"sustain":"idle"}}}}const on=.3,ln=.5,mt=100,Wt=1e4;function cn(n={}){const a=He(),{amount:t=on,tone:r=ln,dryWet:d=1}=n;if(t<0||t>1)throw new Error(`Saturation amount out of range: ${t}. Valid range: 0-1`);if(r<0||r>1)throw new Error(`Saturation tone out of range: ${r}. Valid range: 0-1`);if(d<0||d>1)throw new Error(`Dry/wet balance out of range: ${d}. Valid range: 0-1`);const c=a.createGain();c.gain.value=1+t*2;const o=a.createGain();o.gain.value=1-d;const u=a.createGain();u.gain.value=d;const v=a.createBiquadFilter();v.type="highshelf",v.frequency.value=mt+r*(Wt-mt),v.gain.value=-10+r*20;const m=a.createGain();m.gain.value=1/(1+t*2);let b=t,V=r,A=d;function E(h,p){const w=1+p*50;for(let C=0;C<h.length;C++){const _=h[C];h[C]=_*w/(1+Math.abs(_*w))}}const y=a.createScriptProcessor(4096,1,1);return y.onaudioprocess=h=>{const p=h.inputBuffer.getChannelData(0),w=h.outputBuffer.getChannelData(0);E(p,b);for(let C=0;C<p.length;C++)w[C]=p[C]},c.connect(o),c.connect(y),c.connect(v),o.connect(m),y.connect(v),v.connect(u),u.connect(m),{get input(){return c},get output(){return m},getAmount(){return b},getTone(){return V},getDryWet(){return A},setAmount(h){if(h<0||h>1)throw new Error(`Saturation amount out of range: ${h}. Valid range: 0-1`);b=h;const p=a.currentTime,w=1+h*2;return c.gain.linearRampToValueAtTime(w,p+.05),m.gain.linearRampToValueAtTime(1/w,p+.05),this},setTone(h){if(h<0||h>1)throw new Error(`Saturation tone out of range: ${h}. Valid range: 0-1`);V=h;const p=a.currentTime,w=mt+h*(Wt-mt),C=-10+h*20;return v.frequency.linearRampToValueAtTime(w,p+.05),v.gain.linearRampToValueAtTime(C,p+.05),this},setDryWet(h){if(h<0||h>1)throw new Error(`Dry/wet balance out of range: ${h}. Valid range: 0-1`);A=h;const p=a.currentTime;return o.gain.linearRampToValueAtTime(1-h,p+.05),u.gain.linearRampToValueAtTime(h,p+.05),this},connect(h){return h.connect(this.input),this},disconnect(){return c.disconnect(),o.disconnect(),u.disconnect(),y.disconnect(),v.disconnect(),m.disconnect(),this},getState(){return{amount:b,tone:V,dryWet:A}}}}const vn=-24,dn=4,un=.003,mn=.25,fn=30;function hn(n={}){const a=He(),{threshold:t=vn,ratio:r=dn,attack:d=un,release:c=mn,knee:o=fn,dryWet:u=1}=n;if(t<-100||t>0)throw new Error(`Compressor threshold out of range: ${t} dB. Valid range: -100 to 0 dB`);if(r<1||r>20)throw new Error(`Compression ratio out of range: ${r}. Valid range: 1-20`);if(d<0||d>1)throw new Error(`Attack time out of range: ${d}s. Valid range: 0-1s`);if(c<0||c>2)throw new Error(`Release time out of range: ${c}s. Valid range: 0-2s`);if(u<0||u>1)throw new Error(`Dry/wet balance out of range: ${u}. Valid range: 0-1`);const v=a.createDynamicsCompressor();v.threshold.value=t,v.ratio.value=r,v.attack.value=d,v.release.value=c,v.knee.value=o;const m=a.createGain();m.gain.value=1-u;const b=a.createGain();b.gain.value=u;const V=a.createGain();V.gain.value=1;const A=a.createGain();A.gain.value=1;const E=a.createGain();E.gain.value=1;let y=t,h=r,p=d,w=c,C=u;function _(){const l=y*(1-1/h);return Math.abs(l)/20}return A.connect(m),A.connect(v),v.connect(V),V.connect(b),m.connect(E),b.connect(E),{get input(){return A},get output(){return E},get compressorNode(){return v},getThreshold(){return y},getRatio(){return h},getAttack(){return p},getRelease(){return w},getDryWet(){return C},getReduction(){return v.reduction},setThreshold(l){if(l<-100||l>0)throw new Error(`Compressor threshold out of range: ${l} dB. Valid range: -100 to 0 dB`);y=l;const T=a.currentTime;return v.threshold.linearRampToValueAtTime(l,T+.05),V.gain.linearRampToValueAtTime(_(),T+.05),this},setRatio(l){if(l<1||l>20)throw new Error(`Compression ratio out of range: ${l}. Valid range: 1-20`);h=l;const T=a.currentTime;return v.ratio.linearRampToValueAtTime(l,T+.05),V.gain.linearRampToValueAtTime(_(),T+.05),this},setAttack(l){if(l<0||l>1)throw new Error(`Attack time out of range: ${l}s. Valid range: 0-1s`);p=l;const T=a.currentTime;return v.attack.linearRampToValueAtTime(l,T+.05),this},setRelease(l){if(l<0||l>2)throw new Error(`Release time out of range: ${l}s. Valid range: 0-2s`);w=l;const T=a.currentTime;return v.release.linearRampToValueAtTime(l,T+.05),this},setDryWet(l){if(l<0||l>1)throw new Error(`Dry/wet balance out of range: ${l}. Valid range: 0-1`);C=l;const T=a.currentTime;return m.gain.linearRampToValueAtTime(1-l,T+.05),b.gain.linearRampToValueAtTime(l,T+.05),this},connect(l){return l.connect(this.input),this},disconnect(){return A.disconnect(),m.disconnect(),b.disconnect(),v.disconnect(),V.disconnect(),E.disconnect(),this},getState(){return{threshold:y,ratio:h,attack:p,release:w,dryWet:C,currentReduction:this.getReduction()}}}}const pn=2,gn=.5,bn=.02,yn=.3;function _n(n={}){const a=He(),{decayTime:t=pn,roomSize:r=gn,preDelay:d=bn,dryWet:c=yn}=n;if(t<.1||t>10)throw new Error(`Decay time out of range: ${t}s. Valid range: 0.1-10s`);if(r<0||r>1)throw new Error(`Room size out of range: ${r}. Valid range: 0-1`);if(d<0||d>1)throw new Error(`Pre-delay out of range: ${d}s. Valid range: 0-1s`);if(c<0||c>1)throw new Error(`Dry/wet balance out of range: ${c}. Valid range: 0-1`);const o=a.createGain();o.gain.value=1;const u=a.createGain();u.gain.value=1-c;const v=a.createGain();v.gain.value=c;const m=a.createDelay(5);m.delayTime.value=d;const b=[],V=[.037,.041,.043,.047],A=[];V.forEach(l=>{const T=a.createDelay(l+.1);T.delayTime.value=l*r,b.push(T);const g=a.createGain();g.gain.value=Math.pow(.5,l/t),A.push(g)});const E=a.createGain();E.gain.value=r*.5;const y=a.createBiquadFilter();y.type="lowpass",y.frequency.value=5e3,y.Q.value=.7;const h=a.createGain();h.gain.value=1;let p=t,w=r,C=d,_=c;o.connect(u),o.connect(m),m.connect(b[0]);for(let l=0;l<b.length;l++)b[l].connect(A[l]),A[l].connect(y),l<b.length-1&&A[l].connect(b[l+1]);return y.connect(E),E.connect(m),y.connect(v),u.connect(h),v.connect(h),{get input(){return o},get output(){return h},getDecayTime(){return p},getRoomSize(){return w},getPreDelay(){return C},getDryWet(){return _},setDecayTime(l){if(l<.1||l>10)throw new Error(`Decay time out of range: ${l}s. Valid range: 0.1-10s`);p=l;const T=a.currentTime;return A.forEach((g,I)=>{const M=Math.pow(.5,V[I]/l);g.gain.linearRampToValueAtTime(M,T+.1)}),this},setRoomSize(l){if(l<0||l>1)throw new Error(`Room size out of range: ${l}. Valid range: 0-1`);w=l;const T=a.currentTime;return b.forEach((g,I)=>{const M=V[I]*l;g.delayTime.linearRampToValueAtTime(M,T+.05)}),E.gain.linearRampToValueAtTime(l*.5,T+.05),this},setPreDelay(l){if(l<0||l>1)throw new Error(`Pre-delay out of range: ${l}s. Valid range: 0-1s`);C=l;const T=a.currentTime;return m.delayTime.linearRampToValueAtTime(l,T+.05),this},setDryWet(l){if(l<0||l>1)throw new Error(`Dry/wet balance out of range: ${l}. Valid range: 0-1`);_=l;const T=a.currentTime;return u.gain.linearRampToValueAtTime(1-l,T+.05),v.gain.linearRampToValueAtTime(l,T+.05),this},setTone(l){if(l<100||l>2e4)throw new Error(`Tone frequency out of range: ${l} Hz`);const T=a.currentTime;return y.frequency.linearRampToValueAtTime(l,T+.05),this},connect(l){return l.connect(this.input),this},disconnect(){return o.disconnect(),u.disconnect(),v.disconnect(),m.disconnect(),b.forEach(l=>l.disconnect()),A.forEach(l=>l.disconnect()),E.disconnect(),y.disconnect(),h.disconnect(),this},getState(){return{decayTime:p,roomSize:w,preDelay:C,dryWet:_}}}}function In(){let n=null,a=new Map,t=null,r=null,d=null,c=null;const o={isPlaying:!1,activeNotes:new Set,masterVolume:.5,presetIndex:0,isInitialized:!1},u={frequency:440,detune:[0,15,-20],velocity:100,attackTime:.05,decayTime:.2,sustainLevel:.6,releaseTime:1},v={saturation:{amount:.3,tone:.5,dryWet:1},compression:{threshold:-24,ratio:4,attack:.003,release:.25,dryWet:1},reverb:{decayTime:2,roomSize:.5,preDelay:.02,dryWet:.3}};function m(){try{n=He(),c=n.createGain(),c.gain.value=o.masterVolume,t=cn({amount:v.saturation.amount,tone:v.saturation.tone,dryWet:v.saturation.dryWet}),r=hn({threshold:v.compression.threshold,ratio:v.compression.ratio,attack:v.compression.attack,release:v.compression.release,dryWet:v.compression.dryWet}),d=_n({decayTime:v.reverb.decayTime,roomSize:v.reverb.roomSize,preDelay:v.reverb.preDelay,dryWet:v.reverb.dryWet}),t.input.connect(r.input),r.output.connect(d.input),d.output.connect(c),c.connect(n.destination),o.isInitialized=!0}catch(h){console.error("Failed to initialize audio:",h),o.isInitialized=!1}}function b(){o.isInitialized||m()}function V(){!o.isInitialized||!t||(t.setAmount(v.saturation.amount),t.setTone(v.saturation.tone))}function A(){!o.isInitialized||!r||(r.setThreshold(v.compression.threshold),r.setRatio(v.compression.ratio),r.setAttack(v.compression.attack),r.setRelease(v.compression.release))}function E(){!o.isInitialized||!d||(d.setDecay(v.reverb.decayTime),d.setRoomSize(v.reverb.roomSize))}function y(){!o.isInitialized||!c||c.gain.setValueAtTime(o.masterVolume,He().currentTime)}return{pianoState:o,synthesis:u,effects:v,syncSaturation:V,syncCompression:A,syncReverb:E,syncMasterVolume:y,async init(){b()},playNote(h,p=100,w=null){b();const C=Math.max(0,Math.min(127,h)),_=Tn(C),l=sn({frequency:_,velocity:p,attackTime:u.attackTime,decayTime:u.decayTime,sustainLevel:u.sustainLevel,releaseTime:u.releaseTime,detuneCents:u.detune,velocityScale:.3});l.connect(t.input),l.noteOn(),a.set(C,l),o.activeNotes.add(C),o.isPlaying=o.activeNotes.size>0,w&&setTimeout(()=>{this.stopNote(C)},w)},stopNote(h){const p=Math.max(0,Math.min(127,h)),w=a.get(p);w&&(w.noteOff(),setTimeout(()=>{w.disconnect(),a.delete(p)},u.releaseTime*1e3)),o.activeNotes.delete(p),o.isPlaying=o.activeNotes.size>0},stopAll(){Array.from(o.activeNotes).forEach(h=>{this.stopNote(h)})},setParameter(h,p){const w=h.split(".");let C=this;for(let l=0;l<w.length-1;l++)if(w[l]in C)C=C[w[l]];else{console.warn(`Parameter path not found: ${h}`);return}const _=w[w.length-1];_ in C?C[_]=p:console.warn(`Parameter not found: ${h}`)},getAudioNode(h){return{saturation:t?.output,compression:r?.output,reverb:d?.output,masterGain:c,saturationInput:t?.input,compressionInput:r?.input,reverbInput:d?.input}[h]||null},getState(){return{pianoState:{...o},synthesis:{...u},effects:JSON.parse(JSON.stringify(v)),audioInitialized:o.isInitialized}}}}function Tn(n){return 440*Math.pow(2,(n-69)/12)}var wn=U('<span class="octave-label svelte-1xckpe"> </span>'),kn=U('<span class="note-label svelte-1xckpe"> </span> <!>',1),Vn=U("<button><!></button>"),An=U('<div class="keyboard-container svelte-1xckpe"><div class="keyboard svelte-1xckpe"></div> <div class="keyboard-help svelte-1xckpe"><p class="help-text svelte-1xckpe">ðŸŽ¹ Click keys or press QWERTY keys (Z-M, comma/period) to play</p></div></div>');function Cn(n,a){ye(a,!0);let t=B(a,"audioState",3,void 0),r=B(a,"startNote",3,12),d=B(a,"keyCount",3,88),c=B(a,"showNoteNames",3,!0),o=B(a,"showOctaveNumbers",3,!0),u=W(void 0),v=W(!1),m=Ve(new Map),b=A();const V=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];function A(){return{z:48,x:50,c:52,v:53,b:55,n:57,m:59,s:49,d:51,g:54,h:56,j:58,l:61,",":60,".":62,";":63,"/":64}}function E(x){const D=Math.floor(x/12)-1;return{name:V[x%12],octave:D}}function y(x){const D=x%12;return[1,3,6,8,10].includes(D)}function h(x){if(!t())return;const D=parseInt(x.currentTarget.dataset.note);t().playNote(D,100),m.set(D,x.currentTarget),x.currentTarget.classList.add("active"),S(v,!0)}function p(x){if(!t())return;const D=parseInt(x.currentTarget.dataset.note);t().stopNote(D),m.delete(D),x.currentTarget.classList.remove("active")}function w(x){if(!e(v)||!t())return;const D=parseInt(x.currentTarget.dataset.note);m.has(D)||(t().playNote(D,100),m.set(D,x.currentTarget),x.currentTarget.classList.add("active"))}function C(x){if(!e(v)||!t())return;const D=parseInt(x.currentTarget.dataset.note);m.has(D)&&(t().stopNote(D),m.delete(D),x.currentTarget.classList.remove("active"))}function _(x){if(!t())return;const D=x.key.toLowerCase(),L=b[D];if(L&&!x.repeat){t().playNote(L,100),m.set(L,document.querySelector(`[data-note="${L}"]`));const z=document.querySelector(`[data-note="${L}"]`);z&&z.classList.add("active")}}function l(x){if(!t())return;const D=x.key.toLowerCase(),L=b[D];if(L){t().stopNote(L),m.delete(L);const H=document.querySelector(`[data-note="${L}"]`);H&&H.classList.remove("active")}}function T(){t()&&(t().stopAll(),m.clear()),document.removeEventListener("keydown",_),document.removeEventListener("keyup",l)}st(()=>(document.addEventListener("keydown",_),document.addEventListener("keyup",l),T));function g(){const x=[];for(let D=0;D<d();D++)x.push(r()+D);return x}const I=g();var M=An(),R=s(M);xe(R,22,()=>I,x=>x,(x,D)=>{const L=Y(()=>y(D)),H=Y(()=>E(D)),z=Y(()=>`${e(H).name}${o()?e(H).octave:""}`);var F=Vn();F.__mousedown=h,F.__mouseup=p,F.__touchstart=h,F.__touchend=p;let j;var K=s(F);{var q=N=>{var k=kn(),O=De(k),te=s(O,!0);i(O);var Z=f(O,2);{var ve=re=>{var J=wn(),Q=s(J,!0);i(J),ee(()=>G(Q,e(H).octave)),P(re,J)};se(Z,re=>{o()&&re(ve)})}ee(()=>G(te,e(H).name)),P(N,k)};se(K,N=>{c()&&!e(L)&&N(q)})}i(F),ee(()=>{X(F,"data-note",D),X(F,"title",`${e(z)} (MIDI ${D})`),X(F,"aria-label",`Piano key ${e(z)??""}`),j=Ie(F,1,"svelte-1xckpe",null,j,{key,"white-key":!e(L),"black-key":e(L)})}),pt("mouseleave",F,C),pt("mouseenter",F,w),P(x,F)}),i(R),me(2),i(M),rt(M,x=>S(u,x),()=>e(u)),P(n,M),_e()}$e(["mousedown","mouseup","touchstart","touchend"]);var xn=Nt('<svg class="knob-arc svelte-1prv3hj" viewBox="0 0 100 100"><path class="arc-background svelte-1prv3hj" d="M 50 8 A 42 42 0 0 1 78 78" stroke="var(--color-border)" stroke-width="2" fill="none" stroke-linecap="round"></path><path class="arc-active svelte-1prv3hj" d="M 50 8 A 42 42 0 0 1 78 78" stroke="var(--color-accent)" stroke-width="3" fill="none" stroke-linecap="round"></path></svg>'),En=U('<div class="knob-container svelte-1prv3hj"><div class="knob-label svelte-1prv3hj"> </div> <button role="slider"><!> <div class="knob-grip svelte-1prv3hj"><div class="knob-indicator svelte-1prv3hj"></div></div></button> <div class="sr-only svelte-1prv3hj">Use arrow keys to adjust. Left/Right for coarse, Up/Down for fine control.</div></div>');function Ce(n,a){ye(a,!0);let t=B(a,"value",15,.5),r=B(a,"min",3,0),d=B(a,"max",3,100),c=B(a,"step",3,1),o=B(a,"label",3,"Control"),u=B(a,"showIntensity",3,!0),v=B(a,"disabled",3,!1),m=B(a,"ariaLabel",19,o),b=B(a,"ariaDescribedBy",3,null),V=W(!1),A=W(null),E=W(null),y=Y(()=>(t()-r())/(d()-r())),h=Y(()=>e(y)*270),p=Y(()=>e(y));function w(k){return Math.max(0,Math.min(270,k))/270}function C(k,O){if(!e(A))return 0;const te=e(A).getBoundingClientRect(),Z=te.left+te.width/2,ve=te.top+te.height/2,re=k-Z,J=O-ve;let Q=Math.atan2(J,re)*(180/Math.PI);return Q=Q- -45,Q<0&&(Q+=360),Q}function _(k,O){const te=C(k,O),Z=w(te);t(Math.round((r()+Z*(d()-r()))/c())*c())}function l(k){v()||(S(V,!0),_(k.clientX,k.clientY),document.addEventListener("mousemove",T),document.addEventListener("mouseup",g))}function T(k){e(V)&&(k.preventDefault(),_(k.clientX,k.clientY))}function g(){S(V,!1),document.removeEventListener("mousemove",T),document.removeEventListener("mouseup",g)}function I(k){if(v())return;let O=0;switch(k.key){case"ArrowUp":case"ArrowRight":O=c(),k.preventDefault();break;case"ArrowDown":case"ArrowLeft":O=-c(),k.preventDefault();break;default:return}t(Math.max(r(),Math.min(d(),t()+O)))}function M(k){if(v()||k.touches.length!==1)return;S(V,!0);const O=k.touches[0];_(O.clientX,O.clientY),document.addEventListener("touchmove",R),document.addEventListener("touchend",x)}function R(k){if(!e(V)||k.touches.length!==1)return;k.preventDefault();const O=k.touches[0];_(O.clientX,O.clientY)}function x(){S(V,!1),document.removeEventListener("touchmove",R),document.removeEventListener("touchend",x)}fe(()=>()=>{document.removeEventListener("mousemove",T),document.removeEventListener("mouseup",g),document.removeEventListener("touchmove",R),document.removeEventListener("touchend",x)});var D=En(),L=s(D),H=s(L,!0);i(L);var z=f(L,2);let F;z.__mousedown=l,z.__touchstart=M,z.__keydown=I;var j=s(z);{var K=k=>{var O=xn(),te=f(s(O));i(O),ee(()=>Dt(te,`stroke-dasharray: ${e(h)/270*220}px 220px; opacity: ${e(p)??""};`)),P(k,O)};se(j,k=>{u()&&k(K)})}var q=f(j,2);i(z),rt(z,k=>S(A,k),()=>e(A));var N=f(z,2);i(D),rt(D,k=>S(E,k),()=>e(E)),ee(k=>{G(H,o()),F=Ie(z,1,"knob svelte-1prv3hj",null,F,{dragging:e(V),disabled:v()}),X(z,"aria-label",m()),X(z,"aria-describedby",b()),X(z,"aria-valuemin",r()),X(z,"aria-valuemax",d()),X(z,"aria-valuenow",t()),X(z,"aria-valuetext",k),X(z,"tabindex",v()?-1:0),Dt(q,`transform: rotate(${e(h)??""}deg);`),X(N,"id",`${o()??""}-help`)},[()=>`${t().toFixed(2)}`]),P(n,D),_e()}$e(["mousedown","touchstart","keydown"]);var Sn=U('<div class="age-section svelte-1k9p173"><div class="age-header svelte-1k9p173"><h3 class="age-title svelte-1k9p173">AGE</h3> <div class="age-description svelte-1k9p173"> </div></div> <div class="age-knob-container svelte-1k9p173"><!></div> <div class="sr-only svelte-1k9p173" id="age-help">Adjust vintage character from pristine digital to heavily aged analog. Use arrow keys for fine control.</div></div>');function Mn(n,a){ye(a,!0);let t=B(a,"ageAmount",15,0),r=Y(()=>t()===0?"Digital (pristine)":t()<25?"Subtle warmth":t()<50?"Warm vintage":t()<75?"Rich analog":"Heavily aged");fe(()=>{});var d=Sn(),c=s(d),o=f(s(c),2),u=s(o,!0);i(o),i(c);var v=f(c,2),m=s(v);Ce(m,{min:0,max:100,step:1,label:"Vintage Character",showIntensity:!0,ariaLabel:"AGE - Analog Gear Emulation",ariaDescribedBy:"age-help",get value(){return t()},set value(b){t(b)}}),i(v),me(2),i(d),ee(()=>G(u,e(r))),P(n,d),_e()}var qn=U('<div class="room-section svelte-1903zij"><div class="room-header svelte-1903zij"><h3 class="room-title svelte-1903zij">Room Mics</h3> <div class="room-subtitle svelte-1903zij">Ambient Studio Character</div></div> <div class="room-controls svelte-1903zij"><div class="control-group svelte-1903zij"><!> <div class="control-info svelte-1903zij"> </div></div> <div class="control-group svelte-1903zij"><!> <div class="control-info svelte-1903zij"> </div></div></div> <div class="sr-only svelte-1903zij" id="mix-help">Adjust the balance between dry close-miked signal and ambient room reverb. Left is dry, right is full room.</div> <div class="sr-only svelte-1903zij" id="decay-help">Adjust how long the room reverb sustains. Left is short and tight, right is long and spacious.</div></div>');function Dn(n,a){ye(a,!0);let t=B(a,"roomMix",15,.3),r=B(a,"roomDecay",15,2),d=Y(()=>t()===0?"Dry (no room)":t()<.2?"Close (intimate)":t()<.4?"Balanced":t()<.7?"Ambient":"Lush (full room)"),c=Y(()=>r()<1?"Short (tight)":r()<2?"Medium (natural)":r()<3.5?"Long (spacious)":"Very long (cathedral)");fe(()=>{}),fe(()=>{});var o=qn(),u=f(s(o),2),v=s(u),m=s(v);Ce(m,{min:0,max:1,step:.05,label:"Mix",showIntensity:!0,ariaLabel:"Room Microphone Mix",ariaDescribedBy:"mix-help",get value(){return t()},set value(p){t(p)}});var b=f(m,2),V=s(b,!0);i(b),i(v);var A=f(v,2),E=s(A);Ce(E,{min:.5,max:5,step:.1,label:"Decay",showIntensity:!0,ariaLabel:"Room Reverb Decay Time",ariaDescribedBy:"decay-help",get value(){return r()},set value(p){r(p)}});var y=f(E,2),h=s(y,!0);i(y),i(A),i(u),me(4),i(o),ee(()=>{G(V,e(d)),G(h,e(c))}),P(n,o),_e()}var Ln=U('<div class="harmonic-indicator svelte-cu9oru"><div class="harmonic-bar svelte-cu9oru"></div></div>'),Rn=U('<div class="saturation-section svelte-cu9oru"><div class="saturation-header svelte-cu9oru"><h3 class="saturation-title svelte-cu9oru">Tube Saturation</h3> <div class="saturation-description svelte-cu9oru"> </div></div> <div class="saturation-knob-container svelte-cu9oru"><!></div> <!> <div class="sr-only svelte-cu9oru" id="saturation-help">Adjust tube saturation for warmth and harmonic richness. Increases from clean to heavily saturated.</div></div>');function Nn(n,a){ye(a,!0);let t=B(a,"saturation",15,0),r=Y(()=>Math.min(t()*2,100)),d=Y(()=>t()===0?"Clean (pristine)":t()<20?"Subtle warmth":t()<40?"Warm glow":t()<60?"Rich saturation":t()<80?"Heavy warmth":"Intense coloration");fe(()=>{});var c=Rn(),o=s(c),u=f(s(o),2),v=s(u,!0);i(u),i(o);var m=f(o,2),b=s(m);Ce(b,{min:0,max:100,step:1,label:"Warmth",showIntensity:!0,ariaLabel:"Tube Saturation - Warmth",ariaDescribedBy:"saturation-help",get value(){return t()},set value(E){t(E)}}),i(m);var V=f(m,2);{var A=E=>{var y=Ln(),h=s(y);i(y),ee(()=>Dt(h,`width: ${e(r)??""}%;`)),P(E,y)};se(V,E=>{t()>0&&E(A)})}me(2),i(c),ee(()=>G(v,e(d))),P(n,c),_e()}var zn=U('<span class="status-dot active svelte-m4d8mv"></span> Live Spectrum',1),Pn=U('<span class="status-dot svelte-m4d8mv"></span> Waiting for audio...',1),Fn=U('<div class="spectrum-analyzer svelte-m4d8mv" role="img" aria-label="Audio frequency spectrum visualization"><canvas class="spectrum-canvas svelte-m4d8mv"></canvas> <div class="frequency-labels svelte-m4d8mv"><span class="label svelte-m4d8mv">20 Hz</span> <span class="label svelte-m4d8mv">1 kHz</span> <span class="label svelte-m4d8mv">20 kHz</span></div> <div class="spectrum-info svelte-m4d8mv"><span class="info-text svelte-m4d8mv"><!></span></div></div>');function jn(n,a){ye(a,!0);let t=B(a,"audioContext",3,void 0),r=B(a,"sourceNode",3,void 0),d=B(a,"width",3,600),c=B(a,"height",3,150),o=B(a,"fftSize",3,2048),u=B(a,"smoothing",3,.8),v=W(null),m=W(null),b=W(null),V=W(null),A=W(!1);fe(()=>{if(!t()||!r()){y();return}try{S(m,t().createAnalyser(),!0),e(m).fftSize=o(),e(m).smoothingTimeConstant=u(),r().connect(e(m)),S(b,new Uint8Array(e(m).frequencyBinCount),!0),S(A,!0),E(),console.log(`âœ“ SpectrumAnalyzer initialized: ${e(m).frequencyBinCount} bins`)}catch(g){console.error("SpectrumAnalyzer setup failed:",g),y()}return y});function E(){if(!e(A)||(S(V,requestAnimationFrame(E),!0),!e(m)||!e(b)||!e(v)))return;e(m).getByteFrequencyData(e(b));const g=e(v),I=g.getContext("2d"),M=g.width,R=g.height;I.fillStyle="var(--bg-primary)",I.fillRect(0,0,M,R);const x=Math.floor(e(b).length*.4),D=M/x*.9,L=M/x*.1;for(let H=0;H<x;H++){const F=e(b)[H]/255,j=F*R,K=H*(D+L),q=R-j,N=Math.max(.3,F);I.fillStyle=`rgba(212, 165, 116, ${N})`,I.beginPath(),I.roundRect(K,q,D,j,2),I.fill()}}function y(){if(S(A,!1),e(V)&&(cancelAnimationFrame(e(V)),S(V,null)),e(m)&&r()){try{r().disconnect(e(m))}catch{}S(m,null)}S(b,null)}st(()=>y);var h=Fn(),p=s(h);rt(p,g=>S(v,g),()=>e(v));var w=f(p,4),C=s(w),_=s(C);{var l=g=>{var I=zn();me(),P(g,I)},T=g=>{var I=Pn();me(),P(g,I)};se(_,g=>{e(A)?g(l):g(T,!1)})}i(C),i(w),i(h),ee(()=>{X(p,"width",d()),X(p,"height",c())}),P(n,h),_e()}var Gn=Nt('<line x1="10" stroke="var(--border-color)" stroke-width="1" stroke-dasharray="2,2" opacity="0.3"></line><text x="15" font-size="8" fill="var(--text-muted)" font-family="var(--font-family-mono)"> </text>',1),Bn=Nt('<text text-anchor="middle" font-size="10" font-weight="600" fill="var(--text-primary)" font-family="var(--font-family-mono)"><title> </title> </text>'),Un=U('<div class="envelope-graph svelte-302c9w" role="img" aria-label="ADSR Envelope visualization"><svg class="envelope-svg svelte-302c9w" aria-hidden="true"><rect x="0" y="0" fill="var(--bg-primary)"></rect><!><path fill="none" stroke="var(--accent)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path><path fill="var(--accent)" opacity="0.2"></path><!></svg> <div class="envelope-info svelte-302c9w"><div class="info-row svelte-302c9w"><span class="info-label svelte-302c9w">Attack:</span> <span class="info-value svelte-302c9w"> </span></div> <div class="info-row svelte-302c9w"><span class="info-label svelte-302c9w">Decay:</span> <span class="info-value svelte-302c9w"> </span></div> <div class="info-row svelte-302c9w"><span class="info-label svelte-302c9w">Sustain:</span> <span class="info-value svelte-302c9w"> </span></div> <div class="info-row svelte-302c9w"><span class="info-label svelte-302c9w">Release:</span> <span class="info-value svelte-302c9w"> </span></div></div></div>');function On(n,a){ye(a,!0);let t=B(a,"attack",3,.05),r=B(a,"decay",3,.2),d=B(a,"sustain",3,.7),c=B(a,"release",3,1),o=B(a,"width",3,300),u=B(a,"height",3,120),v=Y(()=>{const j=o()-20,K=u()-2*10,q=t()+r()+.2+c(),N=t()/q*j,k=N+r()/q*j,O=k+.2/q*j,te=j,Z=10,ve=10+(1-d())*K,re=10+K;return`
      M 10 ${re}
      L ${10+N} ${Z}
      L ${10+k} ${ve}
      L ${10+O} ${ve}
      L ${10+te} ${re}
    `.trim()}),m=Y(()=>{const j=u()-20;return[{y:10+j*.25,label:"75%"},{y:10+j*.5,label:"50%"},{y:10+j*.75,label:"25%"}]}),b=Y(()=>{const j=o()-20;u()-2*10;const K=t()+r()+.2+c(),q=t()/K*j,N=q+r()/K*j,k=N+.2/K*j;return[{x:10+q/2,y:u()-5,label:"A",title:`Attack: ${(t()*1e3).toFixed(0)}ms`},{x:10+q+(N-q)/2,y:u()-5,label:"D",title:`Decay: ${(r()*1e3).toFixed(0)}ms`},{x:10+N+(k-N)/2,y:u()-5,label:"S",title:`Sustain: ${(d()*100).toFixed(0)}%`},{x:10+k+(j-k)/2,y:u()-5,label:"R",title:`Release: ${(c()*1e3).toFixed(0)}ms`}]});var V=Un(),A=s(V),E=s(A),y=f(E);xe(y,17,()=>e(m),Le,(F,j)=>{var K=Gn(),q=De(K),N=f(q),k=s(N,!0);i(N),ee(()=>{X(q,"y1",e(j).y),X(q,"x2",o()-10),X(q,"y2",e(j).y),X(N,"y",e(j).y-2),G(k,e(j).label)}),P(F,K)});var h=f(y),p=f(h),w=f(p);xe(w,17,()=>e(b),Le,(F,j)=>{var K=Bn(),q=s(K),N=s(q,!0);i(q);var k=f(q);i(K),ee(()=>{X(K,"x",e(j).x),X(K,"y",e(j).y),G(N,e(j).title),G(k,` ${e(j).label??""}`)}),P(F,K)}),i(A);var C=f(A,2),_=s(C),l=f(s(_),2),T=s(l);i(l),i(_);var g=f(_,2),I=f(s(g),2),M=s(I);i(I),i(g);var R=f(g,2),x=f(s(R),2),D=s(x);i(x),i(R);var L=f(R,2),H=f(s(L),2),z=s(H);i(H),i(L),i(C),i(V),ee((F,j,K,q)=>{X(A,"viewBox",`0 0 ${o()??""} ${u()??""}`),X(E,"width",o()),X(E,"height",u()),X(h,"d",e(v)),X(p,"d",`${e(v)??""} L ${o()-10} ${u()-10} L 10 ${u()-10} Z`),G(T,`${F??""}ms`),G(M,`${j??""}ms`),G(D,`${K??""}%`),G(z,`${q??""}ms`)},[()=>(t()*1e3).toFixed(0),()=>(r()*1e3).toFixed(0),()=>(d()*100).toFixed(0),()=>(c()*1e3).toFixed(0)]),P(n,V),_e()}var Hn=U('<div role="img" aria-label="VU Meter - Audio level monitor"><canvas class="vu-canvas svelte-o6wz6q"></canvas> <div class="level-readout svelte-o6wz6q"><div class="readout-row svelte-o6wz6q"><span class="readout-label svelte-o6wz6q">RMS:</span> <span> </span></div> <div class="readout-row svelte-o6wz6q"><span class="readout-label svelte-o6wz6q">Peak:</span> <span> </span></div></div></div>');function $n(n,a){ye(a,!0);let t=B(a,"audioContext",3,void 0),r=B(a,"sourceNode",3,void 0),d=B(a,"orientation",3,"vertical"),c=B(a,"width",3,40),o=B(a,"height",3,200),u=W(null),v=W(null),m=W(null),b=W(null),V=W(!1),A=W(0),E=W(0),y=W(0);fe(()=>{if(!t()||!r()){_();return}try{S(v,t().createAnalyser(),!0),e(v).fftSize=256,e(v).smoothingTimeConstant=.8,r().connect(e(v)),S(m,new Uint8Array(e(v).frequencyBinCount),!0),S(V,!0),h(),console.log("âœ“ VUMeter initialized")}catch(q){console.error("VUMeter setup failed:",q),_()}return _});function h(){if(!e(V)||(S(b,requestAnimationFrame(h),!0),!e(v)||!e(m)||!e(u)))return;e(v).getByteTimeDomainData(e(m));let q=0;for(let k=0;k<e(m).length;k++){const O=(e(m)[k]-128)/128;q+=O*O}const N=Math.sqrt(q/e(m).length);S(A,e(A)*.8+N*.2),e(A)>e(E)?(S(E,e(A),!0),S(y,0)):(S(y,e(y)+1),e(y)>60&&S(E,Math.max(0,e(E)-.001),!0)),p()}function p(){const q=e(u),N=q.getContext("2d"),k=q.width,O=q.height;N.fillStyle="var(--bg-primary)",N.fillRect(0,0,k,O),d()==="vertical"?w(N,k,O):C(N,k,O)}function w(q,N,k){const O=e(A)*k,te=k-e(E)*k,Z=q.createLinearGradient(0,k,0,0);Z.addColorStop(0,"var(--vu-green)"),Z.addColorStop(.7,"var(--vu-yellow)"),Z.addColorStop(1,"var(--vu-red)"),q.fillStyle=Z,q.fillRect(0,k-O,N,O),e(E)>.05&&(q.fillStyle="var(--accent)",q.fillRect(0,te-2,N,3)),q.strokeStyle="var(--border-color)",q.lineWidth=1,[{db:0,y:0},{db:-6,y:k*.3},{db:-12,y:k*.5},{db:-24,y:k*.7}].forEach(re=>{q.beginPath(),q.moveTo(0,re.y),q.lineTo(N*.3,re.y),q.stroke()})}function C(q,N,k){const O=e(A)*N,te=e(E)*N,Z=q.createLinearGradient(0,0,N,0);Z.addColorStop(0,"var(--vu-green)"),Z.addColorStop(.7,"var(--vu-yellow)"),Z.addColorStop(1,"var(--vu-red)"),q.fillStyle=Z,q.fillRect(0,0,O,k),e(E)>.05&&(q.fillStyle="var(--accent)",q.fillRect(te-2,0,3,k))}function _(){if(S(V,!1),e(b)&&(cancelAnimationFrame(e(b)),S(b,null)),e(v)&&r()){try{r().disconnect(e(v))}catch{}S(v,null)}S(m,null),S(A,0),S(E,0)}st(()=>_);let l=Y(()=>e(A)>.001?Math.round(20*Math.log10(e(A))):-60),T=Y(()=>e(E)>.001?Math.round(20*Math.log10(e(E))):-60);var g=Hn();let I;var M=s(g);rt(M,q=>S(u,q),()=>e(u));var R=f(M,2),x=s(R),D=f(s(x),2);let L;var H=s(D);i(D),i(x);var z=f(x,2),F=f(s(z),2);let j;var K=s(F);i(F),i(z),i(R),i(g),ee(()=>{I=Ie(g,1,"vu-meter svelte-o6wz6q",null,I,{vertical:d()==="vertical",horizontal:d()==="horizontal"}),X(M,"width",c()),X(M,"height",o()),L=Ie(D,1,"readout-value svelte-o6wz6q",null,L,{warn:e(l)>-6,danger:e(l)>-3}),G(H,`${e(l)??""} dB`),j=Ie(F,1,"readout-value svelte-o6wz6q",null,j,{warn:e(T)>-6,danger:e(T)>-3}),G(K,`${e(T)??""} dB`)}),P(n,g),_e()}var Wn=U('<div class="advanced-content svelte-1bdhmma"><div class="subsection svelte-1bdhmma"><h4 class="subsection-title svelte-1bdhmma">Envelope (ADSR)</h4> <div class="knob-grid svelte-1bdhmma"><div class="knob-item svelte-1bdhmma"><!></div> <div class="knob-item svelte-1bdhmma"><!></div> <div class="knob-item svelte-1bdhmma"><!></div> <div class="knob-item svelte-1bdhmma"><!></div></div> <div class="visualizer-container svelte-1bdhmma"><!></div></div> <div class="subsection svelte-1bdhmma"><h4 class="subsection-title svelte-1bdhmma">Compression</h4> <div class="knob-grid svelte-1bdhmma"><div class="knob-item svelte-1bdhmma"><!></div> <div class="knob-item svelte-1bdhmma"><!></div></div></div></div>'),Yn=U('<div class="control-panel svelte-1bdhmma"><section class="control-section svelte-1bdhmma"><div class="section-header svelte-1bdhmma"><h3 class="section-title svelte-1bdhmma">Master Volume</h3></div> <div class="knob-container svelte-1bdhmma"><!></div></section> <section class="control-section visualizer-section svelte-1bdhmma"><div class="section-header svelte-1bdhmma"><h3 class="section-title svelte-1bdhmma">Audio Visualization</h3> <p class="section-description svelte-1bdhmma">Real-time frequency spectrum and level monitoring</p></div> <div class="visualizers-grid svelte-1bdhmma"><div class="visualizer-item spectrum-item svelte-1bdhmma"><!></div> <div class="visualizer-item meter-item svelte-1bdhmma"><!></div></div></section> <!> <!> <!> <section class="control-section advanced-section svelte-1bdhmma"><button class="advanced-toggle svelte-1bdhmma"><span class="toggle-label svelte-1bdhmma"> </span></button> <!></section></div>');function Kn(n,a){ye(a,!0);let t=B(a,"audioState",3,void 0),r=W(Ve(t()?.pianoState?.masterVolume??.5)),d=W(0),c=W(.3),o=W(2),u=W(0),v=W(!1),m=W(Ve(t()?.synthesis?.attackTime??.05)),b=W(Ve(t()?.synthesis?.decayTime??.2)),V=W(Ve(t()?.synthesis?.sustainLevel??.6)),A=W(Ve(t()?.synthesis?.releaseTime??1)),E=W(Ve(t()?.effects?.compression?.threshold??-24)),y=W(Ve(t()?.effects?.compression?.ratio??4));fe(()=>{t()&&t().setParameter("pianoState.masterVolume",e(r))}),fe(()=>{t()&&t().setParameter("effects.saturation.amount",e(u)/100)}),fe(()=>{t()&&(t().setParameter("effects.reverb.dryWet",e(c)),t().setParameter("effects.reverb.decayTime",e(o)))}),fe(()=>{t()&&e(v)&&(t().setParameter("synthesis.attackTime",e(m)),t().setParameter("synthesis.decayTime",e(b)),t().setParameter("synthesis.sustainLevel",e(V)),t().setParameter("synthesis.releaseTime",e(A)))}),fe(()=>{t()&&e(v)&&(t().setParameter("effects.compression.threshold",e(E)),t().setParameter("effects.compression.ratio",e(y)))});function h(){S(v,!e(v))}var p=Yn(),w=s(p),C=f(s(w),2),_=s(C);Ce(_,{min:0,max:1,step:.05,label:"Level",showIntensity:!0,ariaLabel:"Master Volume",get value(){return e(r)},set value(N){S(r,N,!0)}}),i(C),i(w);var l=f(w,2),T=f(s(l),2),g=s(T),I=s(g);{let N=Y(()=>t()?.audioContext),k=Y(()=>t()?.masterGain);jn(I,{get audioContext(){return e(N)},get sourceNode(){return e(k)},width:600,height:150})}i(g);var M=f(g,2),R=s(M);{let N=Y(()=>t()?.audioContext),k=Y(()=>t()?.masterGain);$n(R,{get audioContext(){return e(N)},get sourceNode(){return e(k)},orientation:"vertical",width:40,height:150})}i(M),i(T),i(l);var x=f(l,2);Mn(x,{get ageAmount(){return e(d)},set ageAmount(N){S(d,N,!0)}});var D=f(x,2);Dn(D,{get roomMix(){return e(c)},set roomMix(N){S(c,N,!0)},get roomDecay(){return e(o)},set roomDecay(N){S(o,N,!0)}});var L=f(D,2);Nn(L,{get saturation(){return e(u)},set saturation(N){S(u,N,!0)}});var H=f(L,2),z=s(H);z.__click=h;var F=s(z),j=s(F);i(F),i(z);var K=f(z,2);{var q=N=>{var k=Wn(),O=s(k),te=f(s(O),2),Z=s(te),ve=s(Z);Ce(ve,{min:0,max:.5,step:.01,label:"Attack",ariaLabel:"Attack Time",get value(){return e(m)},set value(ne){S(m,ne,!0)}}),i(Z);var re=f(Z,2),J=s(re);Ce(J,{min:0,max:1,step:.01,label:"Decay",ariaLabel:"Decay Time",get value(){return e(b)},set value(ne){S(b,ne,!0)}}),i(re);var Q=f(re,2),ie=s(Q);Ce(ie,{min:0,max:1,step:.05,label:"Sustain",ariaLabel:"Sustain Level",get value(){return e(V)},set value(ne){S(V,ne,!0)}}),i(Q);var ce=f(Q,2),oe=s(ce);Ce(oe,{min:0,max:3,step:.05,label:"Release",ariaLabel:"Release Time",get value(){return e(A)},set value(ne){S(A,ne,!0)}}),i(ce),i(te);var de=f(te,2),Te=s(de);On(Te,{get attack(){return e(m)},get decay(){return e(b)},get sustain(){return e(V)},get release(){return e(A)},width:400,height:120}),i(de),i(O);var Ae=f(O,2),ge=f(s(Ae),2),we=s(ge),Re=s(we);Ce(Re,{min:-60,max:0,step:1,label:"Threshold",ariaLabel:"Compression Threshold",get value(){return e(E)},set value(ne){S(E,ne,!0)}}),i(we);var Ee=f(we,2),he=s(Ee);Ce(he,{min:1,max:20,step:.5,label:"Ratio",ariaLabel:"Compression Ratio",get value(){return e(y)},set value(ne){S(y,ne,!0)}}),i(Ee),i(ge),i(Ae),i(k),P(N,k)};se(K,N=>{e(v)&&N(q)})}i(H),i(p),ee(()=>G(j,`${e(v)?"â–¼":"â–¶"} Advanced Controls`)),P(n,p),_e()}$e(["click"]);const it={major:{name:"Major",intervals:[0,2,4,5,7,9,11],description:"Bright, happy, resolved",degrees:["I","II","III","IV","V","VI","VII"]},minorNatural:{name:"Minor (Natural)",intervals:[0,2,3,5,7,8,10],description:"Dark, introspective, melancholic",degrees:["I","II","IIIb","IV","V","VIb","VIIb"]},minorHarmonic:{name:"Minor (Harmonic)",intervals:[0,2,3,5,7,8,11],description:"Dark with classical harmonic strength",degrees:["I","II","IIIb","IV","V","VIb","VII"]},minorMelodic:{name:"Minor (Melodic)",intervals:[0,2,3,5,7,9,11],description:"Dark but with melodic ease",degrees:["I","II","IIIb","IV","V","VI","VII"]},dorian:{name:"Dorian",intervals:[0,2,3,5,7,9,10],description:"Jazzy, funky, slightly dark",degrees:["I","II","IIIb","IV","V","VI","VIIb"]},phrygian:{name:"Phrygian",intervals:[0,1,3,5,7,8,10],description:"Spanish, exotic, ominous",degrees:["I","IIb","IIIb","IV","V","VIb","VIIb"]},lydian:{name:"Lydian",intervals:[0,2,4,6,7,9,11],description:"Bright, ethereal, whimsical",degrees:["I","II","III","#IV","V","VI","VII"]},mixolydian:{name:"Mixolydian",intervals:[0,2,4,5,7,9,10],description:"Bluesy, dominant, rock-oriented",degrees:["I","II","III","IV","V","VI","VIIb"]},aeolian:{name:"Aeolian",intervals:[0,2,3,5,7,8,10],description:"Dark, introspective",degrees:["I","II","IIIb","IV","V","VIb","VIIb"]},locrian:{name:"Locrian",intervals:[0,1,3,5,6,8,10],description:"Dark, dissonant, unstable",degrees:["I","IIb","IIIb","IV","Vb","VIb","VIIb"]},majorPentatonic:{name:"Major Pentatonic",intervals:[0,2,4,7,9],description:"Pentatonic, musical, versatile",degrees:["I","II","III","V","VI"]},minorPentatonic:{name:"Minor Pentatonic",intervals:[0,3,5,7,10],description:"Pentatonic blues, versatile",degrees:["I","IIIb","IV","V","VIIb"]},blues:{name:"Blues",intervals:[0,3,5,6,7,10],description:"Blues, rock, with blue notes",degrees:["I","IIIb","IV","Vb","V","VIIb"]}};function Xn(n,a="major",t=2){it[a]||(console.warn(`Unknown scale type: ${a}, defaulting to major`),a="major");const r=it[a],d=[];for(let c=0;c<t;c++)for(const o of r.intervals){const u=n+c*12+o;u>=0&&u<=127&&d.push(u)}return d}function ht(n){return it[n]||it.major}function Qn(){return Object.keys(it)}const Yt={major:[{degree:1,quality:"major",symbol:"I",name:"I",function:"tonic"},{degree:2,quality:"minor",symbol:"ii",name:"ii",function:"pre-dominant"},{degree:3,quality:"minor",symbol:"iii",name:"iii",function:"relative"},{degree:4,quality:"major",symbol:"IV",name:"IV",function:"subdominant"},{degree:5,quality:"major",symbol:"V",name:"V",function:"dominant"},{degree:6,quality:"minor",symbol:"vi",name:"vi",function:"relative"},{degree:7,quality:"diminished",symbol:"viiÂ°",name:"viiÂ°",function:"diminished"}],minorNatural:[{degree:1,quality:"minor",symbol:"i",name:"i",function:"tonic"},{degree:2,quality:"diminished",symbol:"iiÂ°",name:"iiÂ°",function:"diminished"},{degree:3,quality:"major",symbol:"III",name:"III",function:"relative"},{degree:4,quality:"minor",symbol:"iv",name:"iv",function:"subdominant"},{degree:5,quality:"minor",symbol:"v",name:"v",function:"dominant"},{degree:6,quality:"major",symbol:"VI",name:"VI",function:"subdominant"},{degree:7,quality:"major",symbol:"VII",name:"VII",function:"dominant-like"}],minorHarmonic:[{degree:1,quality:"minor",symbol:"i",name:"i",function:"tonic"},{degree:2,quality:"diminished",symbol:"iiÂ°",name:"iiÂ°",function:"diminished"},{degree:3,quality:"augmented",symbol:"III+",name:"III+",function:"relative"},{degree:4,quality:"minor",symbol:"iv",name:"iv",function:"subdominant"},{degree:5,quality:"major",symbol:"V",name:"V",function:"dominant"},{degree:6,quality:"major",symbol:"VI",name:"VI",function:"subdominant"},{degree:7,quality:"diminished",symbol:"viiÂ°",name:"viiÂ°",function:"diminished"}]};function Pt(n,a="major"){const t=Xn(n,a,2),r=Yt[a]||Yt.major,d=[];for(const c of r){const o=c.degree-1,u=t[o],v=[t[o],t[o+2],t[o+4]];d.push({degree:c.degree,roman:c.symbol,root:u,notes:v,quality:c.quality,function:c.function,name:c.name})}return d}function Kt(n,a=0){if(a===0)return n;const t=[...n];for(let r=0;r<a;r++){const d=t.shift();t.push(d+12)}return t}function Jn(n,a){let t=0,r=1/0;const d=[];for(let c=0;c<a.length;c++){const o=Kt(a,c);let u=0;for(let v=0;v<Math.min(n.length,o.length);v++){const m=Math.abs(n[v]-o[v]);u+=m}d.push({inversion:c,distance:u}),u<r&&(r=u,t=c)}return{bestInversion:t,minDistance:r,allDistances:d,suggestedNotes:Kt(a,t)}}const Zn=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],er=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"];function Ke(n,a=!0){(n<0||n>127)&&(console.warn(`MIDI note out of range: ${n}. Clamping to 0-127.`),n=Math.max(0,Math.min(127,n)));const t=Math.floor(n/12)-1,r=n%12;return`${(a?Zn:er)[r]}${t}`}const ca={perfectCadence:{name:"Perfect Cadence",roman:["V","I"],description:"Dominant to Tonic, strong resolution",genre:"classical, universal",feel:"resolved, satisfied",difficulty:"beginner"},plagalCadence:{name:"Plagal Cadence",roman:["IV","I"],description:'Subdominant to Tonic, like "Amen"',genre:"classical, hymns",feel:"resolved, peaceful",difficulty:"beginner"},deceptiveCadence:{name:"Deceptive Cadence",roman:["V","vi"],description:"Dominant expects I but gets vi (relative minor)",genre:"classical, surprise effect",feel:"unexpected, sad turn",difficulty:"intermediate"},popProgression:{name:"Popular Pop Progression",roman:["I","V","vi","IV"],description:"One of the most common progressions in modern pop",genre:"pop, rock",feel:"uplifting, energetic",difficulty:"beginner",repeatable:!0},sadProgression:{name:"Sad Pop Progression",roman:["vi","IV","I","V"],description:"Starts sad (vi=relative minor), resolves happy",genre:"pop, ballads",feel:"emotional journey",difficulty:"beginner",repeatable:!0},circleOfFifths:{name:"Circle of Fifths",roman:["I","IV","viiÂ°","iii","vi","ii","V","I"],description:"Each chord is a perfect 5th below the previous",genre:"baroque, classical, jazz",feel:"sophisticated, musical journey",difficulty:"advanced"},jazzTurnaround:{name:"Jazz Turnaround",roman:["vi","ii","V","I"],description:"Common ending progression in jazz standards",genre:"jazz, standards",feel:"sophisticated, smooth",difficulty:"intermediate",repeatable:!0},iimV:{name:"ii-V-I (Jazz Standard)",roman:["ii","V","I"],description:"Most common progression in jazz, very smooth",genre:"jazz, blues",feel:"smooth, professional",difficulty:"intermediate",repeatable:!0},bluesProgression12Bar:{name:"12-Bar Blues",roman:["I","I","I","I","IV","IV","I","I","V","IV","I","V"],description:"Classic 12-bar blues structure",genre:"blues, rock",feel:"soulful, groovy",difficulty:"beginner",bars:12},blues12BarMinor:{name:"12-Bar Blues (Minor)",roman:["i","i","i","i","iv","iv","i","i","v","iv","i","v"],description:"Classic 12-bar blues in minor key",genre:"blues, rock, metal",feel:"dark, bluesy",difficulty:"beginner",bars:12},singleChord:{name:"Single Chord Vamp",roman:["I"],description:"Focus on rhythm and timbre, not harmony",genre:"minimalism, ambient, techno",feel:"meditative, hypnotic",difficulty:"beginner",repeatable:!0},twoChordVamp:{name:"Two Chord Vamp",roman:["I","IV"],description:"Simple back and forth, very effective",genre:"rock, pop, folk",feel:"driving, energetic",difficulty:"beginner",repeatable:!0}};function tr(n,a,t){const r=Pt(n,a),d=[];let c=null;for(const o of t){const u=r.find(m=>m.roman===o);if(!u){console.warn(`Chord not found: ${o}`);continue}let v={...u};if(c){const m=Jn(c.notes,u.notes);v.voiceLeadingInversion=m.bestInversion,v.notes=m.suggestedNotes,v.voiceLeadingDistance=m.minDistance}d.push(v),c=v}return d}function Rt(n,a="major"){return{I:{primary:"tonic",secondary:[],qualities:["stable","resolved"]},i:{primary:"tonic",secondary:[],qualities:["stable","resolved"]},ii:{primary:"pre-dominant",secondary:["subdominant"],qualities:["stable","smooth"]},"iiÂ°":{primary:"pre-dominant",secondary:[],qualities:["unstable","darkens"]},iii:{primary:"relative",secondary:["tonic"],qualities:["stable","warm"]},III:{primary:"relative",secondary:["subdominant"],qualities:["stable","bright"]},IV:{primary:"subdominant",secondary:[],qualities:["stable","moving-away"]},iv:{primary:"subdominant",secondary:[],qualities:["stable","dark"]},V:{primary:"dominant",secondary:[],qualities:["unstable","tension"]},v:{primary:"dominant",secondary:[],qualities:["unstable","dark-tension"]},VI:{primary:"subdominant",secondary:["tonic-alternative"],qualities:["stable","peaceful"]},vi:{primary:"relative",secondary:["tonic-alternative"],qualities:["stable","sad"]},VII:{primary:"dominant-like",secondary:["dominant"],qualities:["unstable","unusual"]},"viiÂ°":{primary:"dominant",secondary:[],qualities:["unstable","very-tense"]}}[n]||{primary:"unknown",secondary:[],qualities:[]}}function ar(n){let a=0;const t=[];for(let c=1;c<n.length;c++){const o=n[c-1],u=n[c];let v=0;for(let m=0;m<Math.min(o.notes.length,u.notes.length);m++)v+=Math.abs(o.notes[m]-u.notes[m]);t.push(v),a+=v}const r=a/t.length,d=r<5?"excellent":r<10?"good":"fair";return{totalDistance:a,averageDistance:r,quality:d,distances:t,suggestions:d!=="excellent"?["Consider applying voice leading inversions"]:[]}}function Xt(n){return ca[n]}function nr(){return Object.keys(ca)}var rr=U('<option class="svelte-et2eoa"> </option>'),ir=U('<option class="svelte-et2eoa"> </option>'),sr=U('<div class="info-item svelte-et2eoa"><span class="info-label svelte-et2eoa">Feel:</span> <span class="info-value svelte-et2eoa"> </span></div>'),or=U('<div class="info-item full-width svelte-et2eoa"><span class="info-label svelte-et2eoa">Common Usage:</span> <p class="info-text svelte-et2eoa"> </p></div>'),lr=U('<div id="scale-info" class="scale-info svelte-et2eoa"><div class="info-item svelte-et2eoa"><span class="info-label svelte-et2eoa">Pattern:</span> <span class="info-value svelte-et2eoa"> </span></div> <div class="info-item svelte-et2eoa"><span class="info-label svelte-et2eoa">Notes:</span> <span class="info-value svelte-et2eoa"> </span></div> <!> <!></div>'),cr=U("<div> </div>"),vr=U('<div class="chord-selector svelte-et2eoa" role="region" aria-label="Key and Scale Selector"><div class="selector-header svelte-et2eoa"><h2 class="current-key svelte-et2eoa"> </h2> <p class="subtitle svelte-et2eoa">Select your musical key and scale</p></div> <div class="selector-controls svelte-et2eoa"><div class="control-group svelte-et2eoa"><label for="note-select" class="control-label svelte-et2eoa">Root Note</label> <select id="note-select" aria-label="Select root note (C to B)" class="svelte-et2eoa"></select></div> <div class="control-group svelte-et2eoa"><label for="octave-input" class="control-label svelte-et2eoa">Octave</label> <div class="octave-controls svelte-et2eoa"><button class="octave-btn svelte-et2eoa" aria-label="Lower octave" title="Lower by one octave">âˆ’</button> <input id="octave-input" type="number" min="0" max="10" aria-label="Select octave (0-10)" class="svelte-et2eoa"/> <button class="octave-btn svelte-et2eoa" aria-label="Raise octave" title="Raise by one octave">+</button></div></div> <div class="control-group svelte-et2eoa"><label for="scale-select" class="control-label svelte-et2eoa">Scale Type</label> <select id="scale-select" aria-label="Select scale type (Major, Minor, Modes, Pentatonic, etc.)" class="svelte-et2eoa"></select></div></div> <div class="info-section svelte-et2eoa"><button class="info-toggle svelte-et2eoa" aria-controls="scale-info"><span class="toggle-icon svelte-et2eoa"> </span> Scale Information</button> <!></div> <div class="visual-reference svelte-et2eoa"><div class="reference-label svelte-et2eoa"> </div> <div class="keyboard-preview svelte-et2eoa"></div></div></div>');function dr(n,a){ye(a,!0);let t=B(a,"rootMidi",7,60),r=B(a,"scaleType",7,"major"),d=B(a,"onKeyChange",3,void 0),c=B(a,"onScaleChange",3,void 0),o=W(!1);const u=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];let v=Y(()=>{const J=Ke(t(),!0),Q=ht(r())?.name||"Unknown";return`${J} ${Q}`}),m=Y(()=>ht(r())),b=Y(Qn),V=Y(()=>Ke(t(),!0)),A=Y(()=>t()%12),E=Y(()=>Math.floor(t()/12)-1);fe(()=>{d()&&d()(t())}),fe(()=>{c()&&c()(r())});function y(J){const Q=u.indexOf(J);Q>=0&&t(e(E)*12+12+Q)}function h(J){t((J+1)*12+e(A)),t(Math.max(0,Math.min(127,t())))}var p=vr(),w=s(p),C=s(w),_=s(C,!0);i(C),me(2),i(w);var l=f(w,2),T=s(l),g=f(s(T),2);g.__change=J=>y(J.target.value),xe(g,21,()=>u,Le,(J,Q)=>{var ie=rr(),ce=s(ie,!0);i(ie);var oe={};ee(()=>{G(ce,e(Q)),oe!==(oe=e(Q))&&(ie.value=(ie.__value=e(Q))??"")}),P(J,ie)}),i(g);var I;Lt(g),i(T);var M=f(T,2),R=f(s(M),2),x=s(R);x.__click=()=>h(e(E)-1);var D=f(x,2);ft(D),D.__change=J=>h(parseInt(J.target.value));var L=f(D,2);L.__click=()=>h(e(E)+1),i(R),i(M);var H=f(M,2),z=f(s(H),2);z.__change=J=>r(J.target.value),xe(z,21,()=>e(b),Le,(J,Q)=>{var ie=ir(),ce=s(ie,!0);i(ie);var oe={};ee(de=>{G(ce,de),oe!==(oe=e(Q))&&(ie.value=(ie.__value=e(Q))??"")},[()=>ht(e(Q)).name]),P(J,ie)}),i(z);var F;Lt(z),i(H),i(l);var j=f(l,2),K=s(j);K.__click=()=>S(o,!e(o));var q=s(K),N=s(q,!0);i(q),me(),i(K);var k=f(K,2);{var O=J=>{var Q=lr(),ie=s(Q),ce=f(s(ie),2),oe=s(ce,!0);i(ce),i(ie);var de=f(ie,2),Te=f(s(de),2),Ae=s(Te,!0);i(Te),i(de);var ge=f(de,2);{var we=he=>{var ne=sr(),ke=f(s(ne),2),Me=s(ke,!0);i(ke),i(ne),ee(()=>G(Me,e(m).description)),P(he,ne)};se(ge,he=>{e(m).description&&he(we)})}var Re=f(ge,2);{var Ee=he=>{var ne=or(),ke=f(s(ne),2),Me=s(ke,!0);i(ke),i(ne),ee(()=>G(Me,e(m).commonUsage)),P(he,ne)};se(Re,he=>{e(m).commonUsage&&he(Ee)})}i(Q),ee(he=>{G(oe,e(m).pattern),G(Ae,he)},[()=>e(m).degrees.join(" - ")]),P(J,Q)};se(k,J=>{e(o)&&e(m)&&J(O)})}i(j);var te=f(j,2),Z=s(te),ve=s(Z);i(Z);var re=f(Z,2);xe(re,21,()=>u,Le,(J,Q,ie)=>{const ce=Y(()=>e(m)?.intervals.includes(ie));var oe=cr();let de;var Te=s(oe,!0);i(oe),ee(Ae=>{de=Ie(oe,1,"key-preview svelte-et2eoa",null,de,Ae),X(oe,"title",`${e(Q)} ${e(ce)?"(in scale)":"(not in scale)"}`),G(Te,e(Q))},[()=>({"in-scale":e(ce),"root-note":e(Q)===e(V).substring(0,e(V).length-1)})]),P(J,oe)}),i(re),i(te),i(p),ee((J,Q)=>{G(_,e(v)),I!==(I=J)&&(g.value=(g.__value=J)??"",gt(g,J)),x.disabled=t()<12,Ka(D,e(E)),L.disabled=t()>115,F!==(F=r())&&(z.value=(z.__value=r())??"",gt(z,r())),X(K,"aria-expanded",e(o)),G(N,e(o)?"â–¼":"â–¶"),G(ve,`Piano Keys in ${Q??""} ${e(m).name??""}`)},[()=>e(V).substring(0,e(V).length-1),()=>e(V).substring(0,e(V).length-1)]),P(n,p),_e()}$e(["change","click"]);var ur=U('<div class="chord-notes svelte-1n2ognh"> </div>'),mr=U('<button><div class="chord-roman svelte-1n2ognh"> </div> <div class="chord-quality svelte-1n2ognh"> </div> <div> </div> <!></button>'),fr=U(`This chord is the <strong class="svelte-1n2ognh">home base</strong>. It sounds resolved and stable.
              Most progressions start and end here.`,1),hr=U(`This chord moves <strong class="svelte-1n2ognh">away from home</strong>. It's stable but creates forward
              motion, typically leading toward the dominant.`,1),pr=U(`This chord creates <strong class="svelte-1n2ognh">tension</strong> that wants to resolve. It's unstable
              and typically moves to the tonic (home).`,1),gr=U(`This is a <strong class="svelte-1n2ognh">transition chord</strong>. It's stable like the tonic but leads
              naturally toward the dominant.`,1),br=U(`This is a <strong class="svelte-1n2ognh">relative chord</strong>. It shares notes with the tonic but has
              a different character or emotional quality.`,1),yr=U('<div class="function-description svelte-1n2ognh"><div class="description-title svelte-1n2ognh">Harmonic Function</div> <div class="description-text svelte-1n2ognh"><!></div></div>'),_r=U('<div class="chord-details svelte-1n2ognh" role="region" aria-live="polite" aria-label="Selected chord details"><div class="details-header svelte-1n2ognh"><h4 class="selected-chord-name svelte-1n2ognh"> </h4> <button class="play-button svelte-1n2ognh" title="Play this chord"><span class="play-icon svelte-1n2ognh">â–¶</span> <span class="play-text">Play</span></button></div> <div class="details-info svelte-1n2ognh"><div class="detail-item svelte-1n2ognh"><span class="detail-label svelte-1n2ognh">Notes:</span> <span class="detail-value svelte-1n2ognh"> </span></div> <div class="detail-item svelte-1n2ognh"><span class="detail-label svelte-1n2ognh">MIDI:</span> <span class="detail-value svelte-1n2ognh"> </span></div> <div class="detail-item svelte-1n2ognh"><span class="detail-label svelte-1n2ognh">Degree:</span> <span class="detail-value svelte-1n2ognh"> </span></div> <div class="detail-item svelte-1n2ognh"><span class="detail-label svelte-1n2ognh">Function:</span> <span> </span></div></div> <!></div>'),Ir=U('<div class="chord-display svelte-1n2ognh" role="region" aria-label="Diatonic Chords"><div class="display-header svelte-1n2ognh"><h3 class="display-title svelte-1n2ognh">Available Chords</h3> <p class="display-subtitle svelte-1n2ognh"> </p></div> <div class="chords-grid svelte-1n2ognh"></div> <!> <div class="chord-tips svelte-1n2ognh"><div class="tips-title svelte-1n2ognh">ðŸ’¡ Tips</div> <ul class="tips-list svelte-1n2ognh"><li class="svelte-1n2ognh">All 7 chords share the same scale - they sound great together</li> <li class="svelte-1n2ognh">Click a chord to select it and see details</li> <li class="svelte-1n2ognh">Use progressions like I-IV-V-I or vi-IV-I-V for classic sounds</li> <li class="svelte-1n2ognh">The color indicates harmonic function (Tonic, Subdominant, Dominant)</li></ul></div></div>');function Tr(n,a){ye(a,!0);let t=B(a,"rootMidi",3,60),r=B(a,"scaleType",3,"major"),d=B(a,"selectedChordRoman",7,void 0);B(a,"audioState",3,void 0);let c=B(a,"onChordSelect",3,void 0),o=B(a,"onChordPlay",3,void 0),u=W(void 0),v=Y(()=>Pt(t(),r())),m=Y(()=>d()?e(v).find(I=>I.roman===d()):null),b=Y(()=>d()?Rt(d(),r()):null),V=Y(()=>e(m)?e(m).notes.map(I=>Ke(I,!0)):[]);fe(()=>{d()&&c()&&c()(d())}),fe(()=>{!d()&&e(v).length>0&&d(e(v)[0].roman)});function A(I){d(I)}function E(I){o()&&I.notes&&o()(I.notes,1)}function y(I){if(!I)return"Unknown function";const M=[I.primary];return I.secondary&&I.secondary.length>0&&M.push(`(${I.secondary.join(", ")})`),M.join(" ")}function h(I){switch(I){case"tonic":return"function-tonic";case"subdominant":return"function-subdominant";case"dominant":return"function-dominant";case"pre-dominant":return"function-predominant";default:return"function-other"}}var p=Ir(),w=s(p),C=f(s(w),2),_=s(C);i(C),i(w);var l=f(w,2);xe(l,21,()=>e(v),I=>I.roman,(I,M)=>{const R=Y(()=>Rt(e(M).roman,r())),x=Y(()=>e(M).roman===d()),D=Y(()=>e(M).roman===e(u));var L=mr();let H;L.__click=()=>A(e(M).roman);var z=s(L),F=s(z,!0);i(z);var j=f(z,2),K=s(j,!0);i(j);var q=f(j,2),N=s(q,!0);i(q);var k=f(q,2);{var O=te=>{var Z=ur(),ve=s(Z,!0);i(Z),ee(re=>G(ve,re),[()=>e(M).notes.map(re=>Ke(re,!0)).join(" ")]),P(te,Z)};se(k,te=>{(e(x)||e(D))&&te(O)})}i(L),ee(te=>{H=Ie(L,1,`chord-card ${e(R)?.primary?`function-${e(R).primary}`:""}`,"svelte-1n2ognh",H,{selected:e(x),hovered:e(D)}),X(L,"data-chord",e(M).roman),X(L,"aria-pressed",e(x)),X(L,"title",`${e(M).roman} chord - ${e(M).quality} - ${e(M).function}`),G(F,e(M).roman),G(K,e(M).quality),Ie(q,1,`chord-function ${te??""}`,"svelte-1n2ognh"),G(N,e(R)?.primary||"Unknown")},[()=>h(e(R)?.primary)]),pt("mouseenter",L,()=>S(u,e(M).roman,!0)),pt("mouseleave",L,()=>S(u,void 0)),P(I,L)}),i(l);var T=f(l,2);{var g=I=>{var M=_r(),R=s(M),x=s(R),D=s(x);i(x);var L=f(x,2);L.__click=()=>E(e(m)),i(R);var H=f(R,2),z=s(H),F=f(s(z),2),j=s(F,!0);i(F),i(z);var K=f(z,2),q=f(s(K),2),N=s(q,!0);i(q),i(K);var k=f(K,2),O=f(s(k),2),te=s(O);i(O),i(k);var Z=f(k,2),ve=f(s(Z),2),re=s(ve,!0);i(ve),i(Z),i(H);var J=f(H,2);{var Q=ie=>{var ce=yr(),oe=f(s(ce),2),de=s(oe);{var Te=ge=>{var we=fr();me(2),P(ge,we)},Ae=ge=>{var we=Ye(),Re=De(we);{var Ee=ne=>{var ke=hr();me(2),P(ne,ke)},he=ne=>{var ke=Ye(),Me=De(ke);{var Xe=Ne=>{var Be=pr();me(2),P(Ne,Be)},ot=Ne=>{var Be=Ye(),lt=De(Be);{var ct=ze=>{var $=gr();me(2),P(ze,$)},_t=ze=>{var $=Ye(),ae=De($);{var le=ue=>{var Pe=br();me(2),P(ue,Pe)},pe=ue=>{var Pe=ua("This chord has a unique harmonic function in the progression.");P(ue,Pe)};se(ae,ue=>{e(b).primary==="relative"?ue(le):ue(pe,!1)},!0)}P(ze,$)};se(lt,ze=>{e(b).primary==="pre-dominant"?ze(ct):ze(_t,!1)},!0)}P(Ne,Be)};se(Me,Ne=>{e(b).primary==="dominant"?Ne(Xe):Ne(ot,!1)},!0)}P(ne,ke)};se(Re,ne=>{e(b).primary==="subdominant"?ne(Ee):ne(he,!1)},!0)}P(ge,we)};se(de,ge=>{e(b).primary==="tonic"?ge(Te):ge(Ae,!1)})}i(oe),i(ce),P(ie,ce)};se(J,ie=>{e(b)&&ie(Q)})}i(M),ee((ie,ce,oe,de)=>{G(D,`${e(m).roman??""} - ${e(m).quality??""}`),L.disabled=!o(),X(L,"aria-label",`Play ${e(m).roman} chord`),G(j,ie),G(N,ce),G(te,`Scale degree ${e(m).degree??""}`),Ie(ve,1,`detail-value ${oe??""}`,"svelte-1n2ognh"),G(re,de)},[()=>e(V).join(" - "),()=>e(m).notes.join(", "),()=>h(e(b)?.primary),()=>y(e(b))]),P(I,M)};se(T,I=>{e(m)&&I(g)})}me(2),i(p),ee(()=>G(_,`All 7 chords from ${r()??""} scale (harmonically matched)`)),P(n,p),_e()}$e(["click"]);var wr=U('<option class="svelte-16b8ofb"> </option>'),kr=U('<option class="svelte-16b8ofb"> </option>'),Vr=U('<div class="progression-empty svelte-16b8ofb"><p class="svelte-16b8ofb">No chords yet. Load a template or add chords to get started.</p></div>'),Ar=U('<div><div class="item-chord svelte-16b8ofb"><div class="item-roman svelte-16b8ofb"> </div> <div class="item-quality svelte-16b8ofb"> </div></div> <div class="item-details svelte-16b8ofb"><div class="item-notes svelte-16b8ofb"> </div> <div class="item-function svelte-16b8ofb"> </div></div> <button class="item-remove svelte-16b8ofb" title="Remove this chord">Ã—</button></div>'),Cr=U('<div class="progression-sequence svelte-16b8ofb"></div>'),xr=U('<div class="suggestion-item svelte-16b8ofb"> </div>'),Er=U('<div class="analysis-suggestions svelte-16b8ofb"></div>'),Sr=U('<div><div class="analysis-title svelte-16b8ofb">Voice Leading Analysis</div> <div class="analysis-content svelte-16b8ofb"><div class="analysis-item svelte-16b8ofb"><span class="analysis-label svelte-16b8ofb">Quality:</span> <span class="analysis-value svelte-16b8ofb"> </span></div> <div class="analysis-item svelte-16b8ofb"><span class="analysis-label svelte-16b8ofb">Total Movement:</span> <span class="analysis-value svelte-16b8ofb"> </span></div> <div class="analysis-item svelte-16b8ofb"><span class="analysis-label svelte-16b8ofb">Average per Transition:</span> <span class="analysis-value svelte-16b8ofb"> </span></div> <!></div></div>'),Mr=U('<div class="progression-builder svelte-16b8ofb" role="region" aria-label="Chord Progression Builder"><div class="builder-header svelte-16b8ofb"><h3 class="builder-title svelte-16b8ofb">Build a Progression</h3> <p class="builder-subtitle svelte-16b8ofb">Create chord sequences and play them back</p></div> <div class="progression-controls svelte-16b8ofb"><div class="control-group svelte-16b8ofb"><label for="template-select" class="control-label svelte-16b8ofb">Load Template</label> <select id="template-select" aria-label="Load progression template" class="svelte-16b8ofb"><option class="svelte-16b8ofb">Choose a template...</option><!></select></div> <div class="control-group svelte-16b8ofb"><label for="chord-select" class="control-label svelte-16b8ofb">Add Chord</label> <div class="add-chord-row svelte-16b8ofb"><select id="chord-select" aria-label="Select chord to add" class="svelte-16b8ofb"></select> <button class="add-btn svelte-16b8ofb" aria-label="Add chord to progression">+</button></div></div> <div class="control-group svelte-16b8ofb"><label class="control-label svelte-16b8ofb">Actions</label> <div class="button-group svelte-16b8ofb"><button class="action-btn clear-btn svelte-16b8ofb" aria-label="Clear progression" title="Remove all chords">Clear</button></div></div></div> <div class="progression-display svelte-16b8ofb"><div class="progression-title svelte-16b8ofb">Progression</div> <!></div> <div class="playback-section svelte-16b8ofb"><div class="playback-controls svelte-16b8ofb"><button class="play-btn svelte-16b8ofb" aria-label="Play progression" title="Play the progression"><span class="btn-icon svelte-16b8ofb">â–¶</span> <span class="btn-text svelte-16b8ofb">Play</span></button> <button class="stop-btn svelte-16b8ofb" aria-label="Stop playback" title="Stop playing"><span class="btn-icon svelte-16b8ofb">â¹</span> <span class="btn-text svelte-16b8ofb">Stop</span></button> <div class="position-display svelte-16b8ofb">Position: <span class="position-value svelte-16b8ofb"> </span></div></div> <div class="tempo-controls svelte-16b8ofb"><div class="tempo-item svelte-16b8ofb"><label for="tempo-input" class="tempo-label svelte-16b8ofb">Tempo (BPM)</label> <input id="tempo-input" type="range" min="40" max="200" step="1" aria-label="Tempo in beats per minute" class="svelte-16b8ofb"/> <span class="tempo-value svelte-16b8ofb"> </span></div> <div class="tempo-item svelte-16b8ofb"><label for="duration-input" class="tempo-label svelte-16b8ofb">Duration (beats)</label> <input id="duration-input" type="range" min="0.5" max="4" step="0.5" aria-label="Chord duration in beats" class="svelte-16b8ofb"/> <span class="tempo-value svelte-16b8ofb"> </span></div> <div class="loop-control svelte-16b8ofb"><label for="loop-checkbox" class="loop-label svelte-16b8ofb"><input id="loop-checkbox" type="checkbox" aria-label="Loop progression" class="svelte-16b8ofb"/> <span class="svelte-16b8ofb">Loop</span></label></div></div></div> <!> <div class="builder-tips svelte-16b8ofb"><div class="tips-title svelte-16b8ofb">ðŸ’¡ Tips</div> <ul class="tips-list svelte-16b8ofb"><li class="svelte-16b8ofb">Start with a template to see common progressions</li> <li class="svelte-16b8ofb">Voice leading automatically applies optimal chord inversions</li> <li class="svelte-16b8ofb">Adjust tempo to match the mood (slow = 60-80 BPM, fast = 120-160 BPM)</li> <li class="svelte-16b8ofb">Loop to practice the progression repeatedly</li> <li class="svelte-16b8ofb">Notice how voice leading quality affects the smoothness</li></ul></div></div>');function qr(n,a){ye(a,!0);let t=B(a,"rootMidi",3,60),r=B(a,"scaleType",3,"major"),d=B(a,"audioState",3,void 0),c=B(a,"onProgressionChange",3,void 0),o=W(Ve(["I","IV","V","I"])),u=W(!1),v=W(-1),m=W(90),b=W(1),V=W(!1),A=W("I"),E=Y(()=>Pt(t(),r())),y=Y(()=>e(E).map($=>$.roman)),h=Y(()=>{try{return tr(t(),r(),e(o))}catch($){return console.error("Error generating progression:",$),[]}}),p=Y(()=>e(h).length===0?null:ar(e(h))),w=Y(nr),C=Y(()=>e(v)===-1?"â€”":`${e(v)+1} / ${e(o).length}`);fe(()=>{c()&&c()(e(o))}),fe(()=>{e(u)&&M()});function _($){e(y).includes($)&&S(o,[...e(o),$],!0)}function l($){S(o,e(o).filter((ae,le)=>le!==$),!0),e(v)>=e(o).length&&S(v,-1)}function T($){const ae=Xt($);ae&&ae.roman&&(S(o,[...ae.roman],!0),S(v,-1),e(u)&&M())}function g(){S(o,[],!0),S(v,-1),e(u)&&M()}async function I(){if(e(o).length===0||e(u))return;S(u,!0);const $=e(b)*6e4/e(m);do{for(let ae=0;ae<e(o).length;ae++){S(v,ae,!0);const le=e(h)[ae];if(d()&&le&&le.notes&&d().playChord(le.notes,e(b)),await new Promise(pe=>setTimeout(pe,$)),!e(u)){S(v,-1);return}}if(!e(V))break}while(e(u));S(u,!1),S(v,-1)}function M(){S(u,!1),S(v,-1),d()&&d().stopAll&&d().stopAll()}function R($){return Xt($)?.name||$}function x(){if(!e(p))return"";switch(e(p).quality){case"excellent":return"quality-excellent";case"good":return"quality-good";case"fair":return"quality-fair";default:return""}}function D(){if(!e(p))return"";switch(e(p).quality){case"excellent":return"Excellent voice leading - very smooth transitions";case"good":return"Good voice leading - smooth transitions";case"fair":return"Fair voice leading - some larger jumps";default:return"Unknown quality"}}var L=Mr(),H=f(s(L),2),z=s(H),F=f(s(z),2);F.__change=$=>$.target.value&&T($.target.value);var j=s(F);j.value=j.__value="";var K=f(j);xe(K,17,()=>e(w),Le,($,ae)=>{var le=wr(),pe=s(le,!0);i(le);var ue={};ee(Pe=>{G(pe,Pe),ue!==(ue=e(ae))&&(le.value=(le.__value=e(ae))??"")},[()=>R(e(ae))]),P($,le)}),i(F),F.value=F.__value="",i(z);var q=f(z,2),N=f(s(q),2),k=s(N);xe(k,21,()=>e(y),Le,($,ae)=>{var le=kr(),pe=s(le,!0);i(le);var ue={};ee(()=>{G(pe,e(ae)),ue!==(ue=e(ae))&&(le.value=(le.__value=e(ae))??"")}),P($,le)}),i(k);var O=f(k,2);O.__click=()=>_(e(A)),i(N),i(q);var te=f(q,2),Z=f(s(te),2),ve=s(Z);ve.__click=()=>g(),i(Z),i(te),i(H);var re=f(H,2),J=f(s(re),2);{var Q=$=>{var ae=Vr();P($,ae)},ie=$=>{var ae=Cr();xe(ae,21,()=>e(o),Le,(le,pe,ue,Pe)=>{const Ue=Y(()=>e(h)[ue]),Qe=Y(()=>Rt(e(pe),r())),It=Y(()=>ue===e(v)),We=Y(()=>e(Ue)?e(Ue).notes.map(da=>Ke(da,!0)).join(" "):"?");var Fe=Ar();let vt;var Je=s(Fe),Ze=s(Je),Oe=s(Ze,!0);i(Ze);var je=f(Ze,2),et=s(je,!0);i(je),i(Je);var tt=f(Je,2),Ge=s(tt),Tt=s(Ge,!0);i(Ge);var wt=f(Ge,2),va=s(wt,!0);i(wt),i(tt);var Ft=f(tt,2);Ft.__click=()=>l(ue),i(Fe),ee(()=>{vt=Ie(Fe,1,"progression-item svelte-16b8ofb",null,vt,{playing:e(It)}),X(Fe,"data-roman",e(pe)),G(Oe,e(pe)),G(et,e(Ue)?.quality||"?"),X(Ge,"title",e(We)),G(Tt,e(We)),X(wt,"title",e(Qe)?.primary||"Unknown"),G(va,e(Qe)?.primary||"?"),X(Ft,"aria-label",`Remove ${e(pe)} chord`)}),P(le,Fe)}),i(ae),P($,ae)};se(J,$=>{e(o).length===0?$(Q):$(ie,!1)})}i(re);var ce=f(re,2),oe=s(ce),de=s(oe);de.__click=()=>I();var Te=f(de,2);Te.__click=()=>M();var Ae=f(Te,2),ge=f(s(Ae)),we=s(ge,!0);i(ge),i(Ae),i(oe);var Re=f(oe,2),Ee=s(Re),he=f(s(Ee),2);ft(he);var ne=f(he,2),ke=s(ne,!0);i(ne),i(Ee);var Me=f(Ee,2),Xe=f(s(Me),2);ft(Xe);var ot=f(Xe,2),Ne=s(ot,!0);i(ot),i(Me);var Be=f(Me,2),lt=s(Be),ct=s(lt);ft(ct),me(2),i(lt),i(Be),i(Re),i(ce);var _t=f(ce,2);{var ze=$=>{var ae=Sr(),le=f(s(ae),2),pe=s(le),ue=f(s(pe),2),Pe=s(ue,!0);i(ue),i(pe);var Ue=f(pe,2),Qe=f(s(Ue),2),It=s(Qe);i(Qe),i(Ue);var We=f(Ue,2),Fe=f(s(We),2),vt=s(Fe);i(Fe),i(We);var Je=f(We,2);{var Ze=Oe=>{var je=Er();xe(je,21,()=>e(p).suggestions,Le,(et,tt)=>{var Ge=xr(),Tt=s(Ge);i(Ge),ee(()=>G(Tt,`ðŸ’¡ ${e(tt)??""}`)),P(et,Ge)}),i(je),P(Oe,je)};se(Je,Oe=>{e(p).suggestions&&e(p).suggestions.length>0&&Oe(Ze)})}i(le),i(ae),ee((Oe,je,et)=>{Ie(ae,1,`voice-leading-analysis ${Oe??""}`,"svelte-16b8ofb"),G(Pe,je),G(It,`${e(p).totalDistance??""} semitones`),G(vt,`${et??""} semitones`)},[x,D,()=>e(p).averageDistance.toFixed(1)]),P($,ae)};se(_t,$=>{e(p)&&e(o).length>1&&$(ze)})}me(2),i(L),ee(()=>{ve.disabled=e(o).length===0,de.disabled=e(o).length===0||e(u)||!d(),Te.disabled=!e(u),G(we,e(C)),G(ke,e(m)),G(Ne,e(b))}),$a(k,()=>e(A),$=>S(A,$)),Ht(he,()=>e(m),$=>S(m,$)),Ht(Xe,()=>e(b),$=>S(b,$)),Qa(ct,()=>e(V),$=>S(V,$)),P(n,L),_e()}$e(["change","click"]);var Dr=U('<div class="chord-generator svelte-14yssd4" role="main" aria-label="MIDI Chord Generator"><div class="generator-header svelte-14yssd4"><div class="header-content svelte-14yssd4"><h1 class="generator-title svelte-14yssd4">ðŸŽµ MIDI Chord Generator</h1> <p class="generator-subtitle svelte-14yssd4">Build harmonically-coherent chord progressions in any key</p></div> <div class="quick-status svelte-14yssd4"><div class="status-item svelte-14yssd4"><span class="status-label svelte-14yssd4">Current Key:</span> <span class="status-value svelte-14yssd4"> </span></div> <div class="status-item svelte-14yssd4"><span class="status-label svelte-14yssd4">Progression:</span> <span class="status-value svelte-14yssd4"> </span></div></div></div> <div class="generator-content svelte-14yssd4"><section class="content-section selector-section svelte-14yssd4"><!> <!></section> <section class="content-section progression-section svelte-14yssd4"><!></section></div> <footer class="generator-footer svelte-14yssd4"><div class="footer-content svelte-14yssd4"><div class="footer-section svelte-14yssd4"><h3 class="footer-title svelte-14yssd4">ðŸŽ“ Learning Tips</h3> <ul class="footer-list svelte-14yssd4"><li class="svelte-14yssd4"><strong class="svelte-14yssd4">Harmonic Functions:</strong> Tonic (home), Subdominant (moving away), Dominant (tension), Pre-dominant (transition)</li> <li class="svelte-14yssd4"><strong class="svelte-14yssd4">Common Progressions:</strong> I-IV-V-I (classic), vi-IV-I-V (pop), ii-V-I (jazz), I-V-vi-IV (modern pop)</li> <li class="svelte-14yssd4"><strong class="svelte-14yssd4">Voice Leading:</strong> Smooth chord transitions with minimal note movement sound better and are easier to play</li> <li class="svelte-14yssd4"><strong class="svelte-14yssd4">Scale Degrees:</strong> All 7 diatonic chords come from the same scale - they always sound good together!</li></ul></div> <div class="footer-section svelte-14yssd4"><h3 class="footer-title svelte-14yssd4">ðŸŽ¹ Integration Tips</h3> <ul class="footer-list svelte-14yssd4"><li class="svelte-14yssd4">Play individual chords from ChordDisplay to preview them</li> <li class="svelte-14yssd4">Use templates in ProgressionBuilder to learn classic patterns</li> <li class="svelte-14yssd4">Adjust tempo to match different song styles (60 = slow ballad, 140 = upbeat)</li> <li class="svelte-14yssd4">Watch voice leading analysis to understand smooth transitions</li> <li class="svelte-14yssd4">Experiment with different scales and modes to explore new sounds</li></ul></div> <div class="footer-section svelte-14yssd4"><h3 class="footer-title svelte-14yssd4">ðŸ“š Music Theory</h3> <ul class="footer-list svelte-14yssd4"><li class="svelte-14yssd4"><strong class="svelte-14yssd4">Diatonic Chords:</strong> Built from scale degrees, always harmonically compatible</li> <li class="svelte-14yssd4"><strong class="svelte-14yssd4">Voice Leading:</strong> Automatically optimizes chord inversions for smooth movement</li> <li class="svelte-14yssd4"><strong class="svelte-14yssd4">MIDI Note Numbers:</strong> 0-127, Middle C = 60, A4 (concert pitch) = 69 (440 Hz)</li> <li class="svelte-14yssd4"><strong class="svelte-14yssd4">Scale Intervals:</strong> Semitone distances repeated every octave (equal temperament)</li></ul></div></div> <div class="footer-divider svelte-14yssd4"></div> <div class="footer-credit svelte-14yssd4"><p class="svelte-14yssd4">Built with music theory principles from centuries of harmonic practice. Learn more in the <a href="/docs/MUSIC-THEORY-GUIDE.md" class="svelte-14yssd4">Music Theory Guide</a>.</p></div></footer></div>');function Lr(n,a){ye(a,!0);let t=B(a,"audioState",3,void 0),r=B(a,"initialRootMidi",3,60),d=B(a,"initialScaleType",3,"major"),c=W(Ve(r())),o=W(Ve(d())),u=W(void 0),v=W(Ve(["I","IV","V","I"])),m=Y(()=>{const R=Ke(e(c),!0),x=ht(e(o));return`${R} ${x?.name||"Scale"}`});var b=Dr(),V=s(b),A=f(s(V),2),E=s(A),y=f(s(E),2),h=s(y,!0);i(y),i(E);var p=f(E,2),w=f(s(p),2),C=s(w,!0);i(w),i(p),i(A),i(V);var _=f(V,2),l=s(_),T=s(l);dr(T,{onKeyChange:R=>{S(c,R,!0)},onScaleChange:R=>{S(o,R,!0)},get rootMidi(){return e(c)},set rootMidi(R){S(c,R,!0)},get scaleType(){return e(o)},set scaleType(R){S(o,R,!0)}});var g=f(T,2);Tr(g,{get rootMidi(){return e(c)},get scaleType(){return e(o)},get audioState(){return t()},onChordSelect:R=>{S(u,R,!0)},onChordPlay:(R,x)=>{t()&&t().playChord&&t().playChord(R,x||1)},get selectedChordRoman(){return e(u)},set selectedChordRoman(R){S(u,R,!0)}}),i(l);var I=f(l,2),M=s(I);qr(M,{get rootMidi(){return e(c)},get scaleType(){return e(o)},get audioState(){return t()},onProgressionChange:R=>{S(v,R,!0)}}),i(I),i(_),me(2),i(b),ee(R=>{G(h,e(m)),G(C,R)},[()=>e(v).join(" - ")]),P(n,b),_e()}var Rr=U('<div class="view-tabs svelte-qgpshq" role="tablist"><button role="tab" aria-controls="piano-panel">Piano</button> <button role="tab" aria-controls="chords-panel">Chord Generator</button></div> <div class="status-info svelte-qgpshq"><span class="status-indicator svelte-qgpshq">â— Live</span> <span class="note-count svelte-qgpshq"> </span></div>',1),Nr=U('<div class="error-state svelte-qgpshq"><p class="error-icon svelte-qgpshq">âš ï¸</p> <h2 class="svelte-qgpshq">Audio Initialization Failed</h2> <p class="error-message svelte-qgpshq"> </p> <p class="error-help svelte-qgpshq">Try refreshing the page or check browser console for details.</p></div>'),zr=U('<div class="piano-view svelte-qgpshq" id="piano-panel" role="tabpanel"><!> <div class="keyboard-wrapper svelte-qgpshq"><!></div></div>'),Pr=U('<div class="chords-view svelte-qgpshq" id="chords-panel" role="tabpanel"><!></div>'),Fr=U('<div class="app-content svelte-qgpshq"><!></div>'),jr=U('<div class="loading svelte-qgpshq"><div class="spinner svelte-qgpshq"></div> <p class="svelte-qgpshq">Initializing audio system...</p> <p class="loading-hint svelte-qgpshq">Click anywhere to unlock audio (iOS/mobile)</p></div>'),Gr=U('<main class="svelte-qgpshq"><div class="container svelte-qgpshq"><header class="app-header svelte-qgpshq"><div class="header-content svelte-qgpshq"><h1 class="app-title svelte-qgpshq">ðŸŽ¹ LoFi Piano</h1> <p class="app-subtitle svelte-qgpshq">Nostalgic warm piano for lo-fi beats</p></div> <!></header> <!></div></main>');function Br(n,a){ye(a,!0);const t=In();let r=W(!1),d=W(null),c=W("piano");st(async()=>{try{await Ja(),await t.init(),S(r,!0),console.log("âœ“ LoFi Piano initialized"),console.log("  - Audio context ready"),console.log("  - Effect chain connected"),console.log("  - Ready to play")}catch(h){console.error("Failed to initialize audio:",h),S(d,h.message,!0)}});function o(h){S(c,h,!0)}var u=Gr(),v=s(u),m=s(v),b=f(s(m),2);{var V=h=>{var p=Rr(),w=De(p),C=s(w);let _;C.__click=()=>o("piano");var l=f(C,2);let T;l.__click=()=>o("chords"),i(w);var g=f(w,2),I=f(s(g),2),M=s(I);i(I),i(g),ee(()=>{_=Ie(C,1,"tab svelte-qgpshq",null,_,{active:e(c)==="piano"}),X(C,"aria-selected",e(c)==="piano"),T=Ie(l,1,"tab svelte-qgpshq",null,T,{active:e(c)==="chords"}),X(l,"aria-selected",e(c)==="chords"),G(M,`${t.pianoState.activeNotes.size??""} notes`)}),P(h,p)};se(b,h=>{e(r)&&h(V)})}i(m);var A=f(m,2);{var E=h=>{var p=Nr(),w=f(s(p),4),C=s(w,!0);i(w),me(2),i(p),ee(()=>G(C,e(d))),P(h,p)},y=h=>{var p=Ye(),w=De(p);{var C=l=>{var T=Fr(),g=s(T);{var I=R=>{var x=zr(),D=s(x);Kn(D,{get audioState(){return t}});var L=f(D,2),H=s(L);Cn(H,{get audioState(){return t}}),i(L),i(x),P(R,x)},M=R=>{var x=Ye(),D=De(x);{var L=H=>{var z=Pr(),F=s(z);Lr(F,{get audioState(){return t}}),i(z),P(H,z)};se(D,H=>{e(c)==="chords"&&H(L)},!0)}P(R,x)};se(g,R=>{e(c)==="piano"?R(I):R(M,!1)})}i(T),P(l,T)},_=l=>{var T=jr();P(l,T)};se(w,l=>{e(r)?l(C):l(_,!1)},!0)}P(h,p)};se(A,h=>{e(d)?h(E):h(y,!1)})}i(v),i(u),P(n,u),_e()}$e(["click"]);function Xr(n,a){ye(a,!1),st(()=>{console.log("ðŸŽ¹ LoFi Piano loaded")}),Ga(),Br(n,{}),_e()}export{Xr as component};
//# sourceMappingURL=2.Ba3Hf8tR.js.map
