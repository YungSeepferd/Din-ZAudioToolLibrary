import{f as O,a as U,d as Ye,c as We}from"../chunks/B_-0vjWx.js";import"../chunks/eLKtjBVe.js";import{o as Ve}from"../chunks/DgQfwXId.js";import{B as Te,n as $,v as He,q as ze,o as Ke,J as Qe,g as p,X as Xe,L as Je,M as Ze,N as Re,O as be,z as fe,a9 as et,ay as tt,G as Ae,I as at,C as nt,aw as Ge,aF as rt,aB as ot,a6 as De,a8 as it,D as Fe,F as st,aG as lt,aH as _e,E as Pe,aI as ct,aJ as ut,as as dt,aK as vt,av as mt,aL as ft,x as ht,aM as gt,aN as pt,aO as yt,aP as Tt,p as se,Y as ie,k as A,m as w,ah as de,aC as F,Z as z,j as le,aE as Q,t as j,i as Ue,s as x,a as Z}from"../chunks/Dx5WBm0i.js";import{i as bt}from"../chunks/CtsIMZl_.js";import{d as ye,e as Me,s as X}from"../chunks/CHVYgHlj.js";import{p as P,b as ke,i as te}from"../chunks/D67plWE8.js";function _t(i,a,e){for(var n=i.items,l=[],c=a.length,s=0;s<c;s++)vt(a[s].e,l,!0);var v=c>0&&l.length===0&&e!==null;if(v){var o=e.parentNode;mt(o),o.append(e),n.clear(),J(i,a[0].prev,a[c-1].next)}ft(l,()=>{for(var m=0;m<c;m++){var y=a[m];v||(n.delete(y.k),J(i,y.prev,y.next)),Pe(y.e,!v)}})}function Et(i,a,e,n,l,c=null){var s=i,v={flags:a,items:new Map,first:null};{var o=i;s=$?Te(He(o)):o.appendChild(ze())}$&&Ke();var m=null,y=!1,E=new Map,h=Xe(()=>{var d=e();return rt(d)?d:d==null?[]:Ge(d)}),b,g;function r(){wt(g,b,v,E,s,l,a,n,e),c!==null&&(b.length===0?m?Fe(m):m=Ae(()=>c(s)):m!==null&&st(m,()=>{m=null}))}Qe(()=>{g??(g=ht),b=p(h);var d=b.length;if(y&&d===0)return;y=d===0;let T=!1;if($){var _=Je(s)===Ze;_!==(d===0)&&(s=Re(),Te(s),be(!1),T=!0)}if($){for(var u=null,t,f=0;f<d;f++){if(fe.nodeType===et&&fe.data===tt){s=fe,T=!0,be(!1);break}var V=b[f],N=n(V,f);t=qe(fe,v,u,null,V,N,f,l,a,e),v.items.set(N,t),u=t}d>0&&Te(Re())}if($)d===0&&c&&(m=Ae(()=>c(s)));else if(at()){var M=new Set,I=nt;for(f=0;f<d;f+=1){V=b[f],N=n(V,f);var k=v.items.get(N)??E.get(N);k?Oe(k,V,f):(t=qe(null,v,null,null,V,N,f,l,a,e,!0),E.set(N,t)),M.add(N)}for(const[q,R]of v.items)M.has(q)||I.skipped_effects.add(R.e);I.oncommit(r)}else r();T&&be(!0),p(h)}),$&&(s=fe)}function wt(i,a,e,n,l,c,s,v,o){var m=a.length,y=e.items,E=e.first,h=E,b,g=null,r=[],d=[],T,_,u,t;for(t=0;t<m;t+=1){if(T=a[t],_=v(T,t),u=y.get(_),u===void 0){var f=n.get(_);if(f!==void 0){n.delete(_),y.set(_,f);var V=g?g.next:h;J(e,g,f),J(e,f,V),Ee(f,V,l),g=f}else{var N=h?h.e.nodes_start:l;g=qe(N,e,g,g===null?e.first:g.next,T,_,t,c,s,o)}y.set(_,g),r=[],d=[],h=g.next;continue}if(Oe(u,T,t),u.e.f&_e&&Fe(u.e),u!==h){if(b!==void 0&&b.has(u)){if(r.length<d.length){var M=d[0],I;g=M.prev;var k=r[0],q=r[r.length-1];for(I=0;I<r.length;I+=1)Ee(r[I],M,l);for(I=0;I<d.length;I+=1)b.delete(d[I]);J(e,k.prev,q.next),J(e,g,k),J(e,q,M),h=M,g=q,t-=1,r=[],d=[]}else b.delete(u),Ee(u,h,l),J(e,u.prev,u.next),J(e,u,g===null?e.first:g.next),J(e,g,u),g=u;continue}for(r=[],d=[];h!==null&&h.k!==_;)h.e.f&_e||(b??(b=new Set)).add(h),d.push(h),h=h.next;if(h===null)continue;u=h}r.push(u),g=u,h=u.next}if(h!==null||b!==void 0){for(var R=b===void 0?[]:Ge(b);h!==null;)h.e.f&_e||R.push(h),h=h.next;var C=R.length;if(C>0){var D=m===0?l:null;_t(e,R,D)}}i.first=e.first&&e.first.e,i.last=g&&g.e;for(var G of n.values())Pe(G.e);n.clear()}function Oe(i,a,e,n){it(i.i,e)}function qe(i,a,e,n,l,c,s,v,o,m,y){var E=(o&ct)!==0,h=(o&ut)===0,b=E?h?ot(l,!1,!1):De(l):l,g=o&lt?De(s):s,r={i:g,v:b,k:c,a:null,e:null,prev:e,next:n};try{if(i===null){var d=document.createDocumentFragment();d.append(i=ze())}return r.e=Ae(()=>v(i,b,g,m),$),r.e.prev=e&&e.e,r.e.next=n&&n.e,e===null?y||(a.first=r):(e.next=r,e.e.next=r.e),n!==null&&(n.prev=r,n.e.prev=r.e),r}finally{}}function Ee(i,a,e){for(var n=i.next?i.next.e.nodes_start:e,l=a?a.e.nodes_start:e,c=i.e.nodes_start;c!==null&&c!==n;){var s=dt(c);l.before(c),c=s}}function J(i,a,e){a===null?i.first=e:(a.next=e,a.e.next=e&&e.e),e!==null&&(e.prev=a,e.e.prev=a&&a.e)}const Ce=[...` 	
\r\f¬†\v\uFEFF`];function At(i,a,e){var n=i==null?"":""+i;if(e){for(var l in e)if(e[l])n=n?n+" "+l:l;else if(n.length)for(var c=l.length,s=0;(s=n.indexOf(l,s))>=0;){var v=s+c;(s===0||Ce.includes(n[s-1]))&&(v===n.length||Ce.includes(n[v]))?n=(s===0?"":n.substring(0,s))+n.substring(v+1):s=v}}return n===""?null:n}function kt(i,a){return i==null?null:String(i)}function Be(i,a,e,n,l,c){var s=i.__className;if($||s!==e||s===void 0){var v=At(e,n,c);(!$||v!==i.getAttribute("class"))&&(v==null?i.removeAttribute("class"):i.className=v),i.__className=e}else if(c&&l!==c)for(var o in c){var m=!!c[o];(l==null||m!==!!l[o])&&i.classList.toggle(o,m)}return c}function Le(i,a,e,n){var l=i.__style;if($||l!==a){var c=kt(a);(!$||c!==i.getAttribute("style"))&&(c==null?i.removeAttribute("style"):i.style.cssText=c),i.__style=a}return n}const qt=Symbol("is custom element"),Lt=Symbol("is html");function H(i,a,e,n){var l=Vt(i);$&&(l[a]=i.getAttribute(a),a==="src"||a==="srcset"||a==="href"&&i.nodeName==="LINK")||l[a]!==(l[a]=e)&&(a==="loading"&&(i[gt]=e),e==null?i.removeAttribute(a):typeof e!="string"&&xt(i).includes(a)?i[a]=e:i.setAttribute(a,e))}function Vt(i){return i.__attributes??(i.__attributes={[qt]:i.nodeName.includes("-"),[Lt]:i.namespaceURI===pt})}var Se=new Map;function xt(i){var a=i.getAttribute("is")||i.nodeName,e=Se.get(a);if(e)return e;Se.set(a,e=[]);for(var n,l=i,c=Element.prototype;c!==l;){n=Tt(l);for(var s in n)n[s].set&&e.push(s);l=yt(l)}return e}let we=null;function ue(){if(!we){const i=typeof window<"u"&&(window.AudioContext||window.webkitAudioContext)||globalThis.AudioContext||globalThis.webkitAudioContext;if(!i)throw new Error("AudioContext is not available in this environment");we=new i}return we}async function Rt(){const i=ue();if(i.state==="suspended"){const a=i.createBuffer(1,1,8e3),e=i.createBufferSource();e.buffer=a,e.connect(i.destination),e.start(0);try{await i.resume(),console.log("‚úì AudioContext unlocked")}catch(n){console.error("Failed to unlock AudioContext:",n)}}}const Dt=[0,15,-20],Mt=.05,Ct=.2,St=.6,Nt=1,Ne=.05,It=.01,he=20,ge=2e4;function zt(i={}){const a=ue(),{frequency:e=440,velocity:n=100,attackTime:l=Mt,decayTime:c=Ct,sustainLevel:s=St,releaseTime:v=Nt,detuneCents:o=Dt,velocityScale:m=.3}=i;if(e<he||e>ge)throw new Error(`Frequency out of range: ${e} Hz. Valid range: ${he}-${ge} Hz`);if(n<0||n>127)throw new Error(`Velocity out of range: ${n}. Valid range: 0-127`);if(l<0||c<0||v<0)throw new Error("Attack, decay, and release times must be non-negative");if(s<0||s>1)throw new Error("Sustain level must be between 0 and 1");const y=o.map(u=>{const t=a.createOscillator();return t.type="sine",t.frequency.value=e,t.detune.value=u,t}),E=a.createGain();E.gain.value=0;const h=a.createGain(),b=n/127;h.gain.value=b*m;let g=!1,r=e,d=n,T=[...o];y.forEach(u=>u.connect(E)),E.connect(h);function _(u,t,f,V){if(u<0||t<0||V<0)throw new Error("Envelope times must be non-negative");if(f<0||f>1)throw new Error("Sustain level must be between 0 and 1")}return{oscillators:y,envelope:E,velocityGain:h,getIsPlaying(){return g},getFrequency(){return r},getVelocity(){return d},getDetuning(){return[...T]},noteOn(){g&&this.noteOff();const u=a.currentTime;return g=!0,y.forEach(t=>t.start(u)),E.gain.setValueAtTime(0,u),E.gain.linearRampToValueAtTime(1,u+l),E.gain.linearRampToValueAtTime(s,u+l+c),this},noteOff(){const u=a.currentTime;return g=!1,E.gain.setValueAtTime(E.gain.value,u),E.gain.linearRampToValueAtTime(0,u+v),y.forEach(t=>t.stop(u+v)),this},connect(u){return h.connect(u),this},disconnect(){return h.disconnect(),this},setFrequency(u){if(u<he||u>ge)throw new Error(`Frequency out of range: ${u} Hz. Valid range: ${he}-${ge} Hz`);r=u;const t=a.currentTime;return y.forEach(f=>{f.frequency.linearRampToValueAtTime(u,t+Ne)}),this},setVelocity(u){if(u<0||u>127)throw new Error(`Velocity out of range: ${u}. Valid range: 0-127`);d=u;const t=a.currentTime,f=u/127;return h.gain.linearRampToValueAtTime(f*m,t+It),this},setDetuning(u){if(u.length!==y.length)throw new Error(`Detuning array length (${u.length}) must match oscillator count (${y.length})`);T=[...u];const t=a.currentTime;return y.forEach((f,V)=>{f.detune.linearRampToValueAtTime(u[V],t+Ne)}),this},setEnvelope(u){const{attackTime:t,decayTime:f,sustainLevel:V,releaseTime:N}=u;return _(t,f,V,N),this},getState(){return{isPlaying:g,frequency:r,velocity:d,detuning:[...T],envelopePhase:g?"sustain":"idle"}}}}const Gt=.3,Ft=.5,pe=100,Ie=1e4;function Pt(i={}){const a=ue(),{amount:e=Gt,tone:n=Ft,dryWet:l=1}=i;if(e<0||e>1)throw new Error(`Saturation amount out of range: ${e}. Valid range: 0-1`);if(n<0||n>1)throw new Error(`Saturation tone out of range: ${n}. Valid range: 0-1`);if(l<0||l>1)throw new Error(`Dry/wet balance out of range: ${l}. Valid range: 0-1`);const c=a.createGain();c.gain.value=1+e*2;const s=a.createGain();s.gain.value=1-l;const v=a.createGain();v.gain.value=l;const o=a.createBiquadFilter();o.type="highshelf",o.frequency.value=pe+n*(Ie-pe),o.gain.value=-10+n*20;const m=a.createGain();m.gain.value=1/(1+e*2);let y=e,E=n,h=l;function b(r,d){const T=1+d*50;for(let _=0;_<r.length;_++){const u=r[_];r[_]=u*T/(1+Math.abs(u*T))}}const g=a.createScriptProcessor(4096,1,1);return g.onaudioprocess=r=>{const d=r.inputBuffer.getChannelData(0),T=r.outputBuffer.getChannelData(0);b(d,y);for(let _=0;_<d.length;_++)T[_]=d[_]},c.connect(s),c.connect(g),c.connect(o),s.connect(m),g.connect(o),o.connect(v),v.connect(m),{get input(){return c},get output(){return m},getAmount(){return y},getTone(){return E},getDryWet(){return h},setAmount(r){if(r<0||r>1)throw new Error(`Saturation amount out of range: ${r}. Valid range: 0-1`);y=r;const d=a.currentTime,T=1+r*2;return c.gain.linearRampToValueAtTime(T,d+.05),m.gain.linearRampToValueAtTime(1/T,d+.05),this},setTone(r){if(r<0||r>1)throw new Error(`Saturation tone out of range: ${r}. Valid range: 0-1`);E=r;const d=a.currentTime,T=pe+r*(Ie-pe),_=-10+r*20;return o.frequency.linearRampToValueAtTime(T,d+.05),o.gain.linearRampToValueAtTime(_,d+.05),this},setDryWet(r){if(r<0||r>1)throw new Error(`Dry/wet balance out of range: ${r}. Valid range: 0-1`);h=r;const d=a.currentTime;return s.gain.linearRampToValueAtTime(1-r,d+.05),v.gain.linearRampToValueAtTime(r,d+.05),this},connect(r){return r.connect(this.input),this},disconnect(){return c.disconnect(),s.disconnect(),v.disconnect(),g.disconnect(),o.disconnect(),m.disconnect(),this},getState(){return{amount:y,tone:E,dryWet:h}}}}const Ut=-24,Ot=4,Bt=.003,$t=.25,jt=30;function Yt(i={}){const a=ue(),{threshold:e=Ut,ratio:n=Ot,attack:l=Bt,release:c=$t,knee:s=jt,dryWet:v=1}=i;if(e<-100||e>0)throw new Error(`Compressor threshold out of range: ${e} dB. Valid range: -100 to 0 dB`);if(n<1||n>20)throw new Error(`Compression ratio out of range: ${n}. Valid range: 1-20`);if(l<0||l>1)throw new Error(`Attack time out of range: ${l}s. Valid range: 0-1s`);if(c<0||c>2)throw new Error(`Release time out of range: ${c}s. Valid range: 0-2s`);if(v<0||v>1)throw new Error(`Dry/wet balance out of range: ${v}. Valid range: 0-1`);const o=a.createDynamicsCompressor();o.threshold.value=e,o.ratio.value=n,o.attack.value=l,o.release.value=c,o.knee.value=s;const m=a.createGain();m.gain.value=1-v;const y=a.createGain();y.gain.value=v;const E=a.createGain();E.gain.value=1;const h=a.createGain();h.gain.value=1;const b=a.createGain();b.gain.value=1;let g=e,r=n,d=l,T=c,_=v;function u(){const t=g*(1-1/r);return Math.abs(t)/20}return h.connect(m),h.connect(o),o.connect(E),E.connect(y),m.connect(b),y.connect(b),{get input(){return h},get output(){return b},get compressorNode(){return o},getThreshold(){return g},getRatio(){return r},getAttack(){return d},getRelease(){return T},getDryWet(){return _},getReduction(){return o.reduction},setThreshold(t){if(t<-100||t>0)throw new Error(`Compressor threshold out of range: ${t} dB. Valid range: -100 to 0 dB`);g=t;const f=a.currentTime;return o.threshold.linearRampToValueAtTime(t,f+.05),E.gain.linearRampToValueAtTime(u(),f+.05),this},setRatio(t){if(t<1||t>20)throw new Error(`Compression ratio out of range: ${t}. Valid range: 1-20`);r=t;const f=a.currentTime;return o.ratio.linearRampToValueAtTime(t,f+.05),E.gain.linearRampToValueAtTime(u(),f+.05),this},setAttack(t){if(t<0||t>1)throw new Error(`Attack time out of range: ${t}s. Valid range: 0-1s`);d=t;const f=a.currentTime;return o.attack.linearRampToValueAtTime(t,f+.05),this},setRelease(t){if(t<0||t>2)throw new Error(`Release time out of range: ${t}s. Valid range: 0-2s`);T=t;const f=a.currentTime;return o.release.linearRampToValueAtTime(t,f+.05),this},setDryWet(t){if(t<0||t>1)throw new Error(`Dry/wet balance out of range: ${t}. Valid range: 0-1`);_=t;const f=a.currentTime;return m.gain.linearRampToValueAtTime(1-t,f+.05),y.gain.linearRampToValueAtTime(t,f+.05),this},connect(t){return t.connect(this.input),this},disconnect(){return h.disconnect(),m.disconnect(),y.disconnect(),o.disconnect(),E.disconnect(),b.disconnect(),this},getState(){return{threshold:g,ratio:r,attack:d,release:T,dryWet:_,currentReduction:this.getReduction()}}}}const Wt=2,Ht=.5,Kt=.02,Qt=.3;function Xt(i={}){const a=ue(),{decayTime:e=Wt,roomSize:n=Ht,preDelay:l=Kt,dryWet:c=Qt}=i;if(e<.1||e>10)throw new Error(`Decay time out of range: ${e}s. Valid range: 0.1-10s`);if(n<0||n>1)throw new Error(`Room size out of range: ${n}. Valid range: 0-1`);if(l<0||l>1)throw new Error(`Pre-delay out of range: ${l}s. Valid range: 0-1s`);if(c<0||c>1)throw new Error(`Dry/wet balance out of range: ${c}. Valid range: 0-1`);const s=a.createGain();s.gain.value=1;const v=a.createGain();v.gain.value=1-c;const o=a.createGain();o.gain.value=c;const m=a.createDelay(5);m.delayTime.value=l;const y=[],E=[.037,.041,.043,.047],h=[];E.forEach(t=>{const f=a.createDelay(t+.1);f.delayTime.value=t*n,y.push(f);const V=a.createGain();V.gain.value=Math.pow(.5,t/e),h.push(V)});const b=a.createGain();b.gain.value=n*.5;const g=a.createBiquadFilter();g.type="lowpass",g.frequency.value=5e3,g.Q.value=.7;const r=a.createGain();r.gain.value=1;let d=e,T=n,_=l,u=c;s.connect(v),s.connect(m),m.connect(y[0]);for(let t=0;t<y.length;t++)y[t].connect(h[t]),h[t].connect(g),t<y.length-1&&h[t].connect(y[t+1]);return g.connect(b),b.connect(m),g.connect(o),v.connect(r),o.connect(r),{get input(){return s},get output(){return r},getDecayTime(){return d},getRoomSize(){return T},getPreDelay(){return _},getDryWet(){return u},setDecayTime(t){if(t<.1||t>10)throw new Error(`Decay time out of range: ${t}s. Valid range: 0.1-10s`);d=t;const f=a.currentTime;return h.forEach((V,N)=>{const M=Math.pow(.5,E[N]/t);V.gain.linearRampToValueAtTime(M,f+.1)}),this},setRoomSize(t){if(t<0||t>1)throw new Error(`Room size out of range: ${t}. Valid range: 0-1`);T=t;const f=a.currentTime;return y.forEach((V,N)=>{const M=E[N]*t;V.delayTime.linearRampToValueAtTime(M,f+.05)}),b.gain.linearRampToValueAtTime(t*.5,f+.05),this},setPreDelay(t){if(t<0||t>1)throw new Error(`Pre-delay out of range: ${t}s. Valid range: 0-1s`);_=t;const f=a.currentTime;return m.delayTime.linearRampToValueAtTime(t,f+.05),this},setDryWet(t){if(t<0||t>1)throw new Error(`Dry/wet balance out of range: ${t}. Valid range: 0-1`);u=t;const f=a.currentTime;return v.gain.linearRampToValueAtTime(1-t,f+.05),o.gain.linearRampToValueAtTime(t,f+.05),this},setTone(t){if(t<100||t>2e4)throw new Error(`Tone frequency out of range: ${t} Hz`);const f=a.currentTime;return g.frequency.linearRampToValueAtTime(t,f+.05),this},connect(t){return t.connect(this.input),this},disconnect(){return s.disconnect(),v.disconnect(),o.disconnect(),m.disconnect(),y.forEach(t=>t.disconnect()),h.forEach(t=>t.disconnect()),b.disconnect(),g.disconnect(),r.disconnect(),this},getState(){return{decayTime:d,roomSize:T,preDelay:_,dryWet:u}}}}function Jt(){let i=null,a=new Map,e=null,n=null,l=null,c=null;const s={isPlaying:!1,activeNotes:new Set,masterVolume:.5,presetIndex:0,isInitialized:!1},v={frequency:440,detune:[0,15,-20],velocity:100,attackTime:.05,decayTime:.2,sustainLevel:.6,releaseTime:1},o={saturation:{amount:.3,tone:.5,dryWet:1},compression:{threshold:-24,ratio:4,attack:.003,release:.25,dryWet:1},reverb:{decayTime:2,roomSize:.5,preDelay:.02,dryWet:.3}};function m(){try{i=ue(),c=i.createGain(),c.gain.value=s.masterVolume,e=Pt({amount:o.saturation.amount,tone:o.saturation.tone,dryWet:o.saturation.dryWet}),n=Yt({threshold:o.compression.threshold,ratio:o.compression.ratio,attack:o.compression.attack,release:o.compression.release,dryWet:o.compression.dryWet}),l=Xt({decayTime:o.reverb.decayTime,roomSize:o.reverb.roomSize,preDelay:o.reverb.preDelay,dryWet:o.reverb.dryWet}),e.input.connect(n.input),n.output.connect(l.input),l.output.connect(c),c.connect(i.destination),s.isInitialized=!0}catch(r){console.error("Failed to initialize audio:",r),s.isInitialized=!1}}function y(){s.isInitialized||m()}function E(){!s.isInitialized||!e||(e.setAmount(o.saturation.amount),e.setTone(o.saturation.tone))}function h(){!s.isInitialized||!n||(n.setThreshold(o.compression.threshold),n.setRatio(o.compression.ratio),n.setAttack(o.compression.attack),n.setRelease(o.compression.release))}function b(){!s.isInitialized||!l||(l.setDecay(o.reverb.decayTime),l.setRoomSize(o.reverb.roomSize))}function g(){!s.isInitialized||!c||c.gain.setValueAtTime(s.masterVolume,ue().currentTime)}return{pianoState:s,synthesis:v,effects:o,syncSaturation:E,syncCompression:h,syncReverb:b,syncMasterVolume:g,async init(){y()},playNote(r,d=100,T=null){y();const _=Math.max(0,Math.min(127,r)),u=Zt(_),t=zt({frequency:u,velocity:d,attackTime:v.attackTime,decayTime:v.decayTime,sustainLevel:v.sustainLevel,releaseTime:v.releaseTime,detuneCents:v.detune,velocityScale:.3});t.connect(e.input),t.noteOn(),a.set(_,t),s.activeNotes.add(_),s.isPlaying=s.activeNotes.size>0,T&&setTimeout(()=>{this.stopNote(_)},T)},stopNote(r){const d=Math.max(0,Math.min(127,r)),T=a.get(d);T&&(T.noteOff(),setTimeout(()=>{T.disconnect(),a.delete(d)},v.releaseTime*1e3)),s.activeNotes.delete(d),s.isPlaying=s.activeNotes.size>0},stopAll(){Array.from(s.activeNotes).forEach(r=>{this.stopNote(r)})},setParameter(r,d){const T=r.split(".");let _=this;for(let t=0;t<T.length-1;t++)if(T[t]in _)_=_[T[t]];else{console.warn(`Parameter path not found: ${r}`);return}const u=T[T.length-1];u in _?_[u]=d:console.warn(`Parameter not found: ${r}`)},getAudioNode(r){return{saturation:e?.output,compression:n?.output,reverb:l?.output,masterGain:c,saturationInput:e?.input,compressionInput:n?.input,reverbInput:l?.input}[r]||null},getState(){return{pianoState:{...s},synthesis:{...v},effects:JSON.parse(JSON.stringify(o)),audioInitialized:s.isInitialized}}}}function Zt(i){return 440*Math.pow(2,(i-69)/12)}var ea=O('<span class="octave-label svelte-1xckpe"> </span>'),ta=O('<span class="note-label svelte-1xckpe"> </span> <!>',1),aa=O("<button><!></button>"),na=O('<div class="keyboard-container svelte-1xckpe"><div class="keyboard svelte-1xckpe"></div> <div class="keyboard-help svelte-1xckpe"><p class="help-text svelte-1xckpe">üéπ Click keys or press QWERTY keys (Z-M, comma/period) to play</p></div></div>');function ra(i,a){se(a,!0);let e=P(a,"audioState",3,void 0),n=P(a,"startNote",3,12),l=P(a,"keyCount",3,88),c=P(a,"showNoteNames",3,!0),s=P(a,"showOctaveNumbers",3,!0),v=F(void 0),o=F(!1),m=ie(new Map),y=h();const E=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];function h(){return{z:48,s:49,x:50,d:51,c:52,v:53,g:54,b:55,h:56,n:57,j:58,m:59,",":60,l:61,".":62,";":63,"/":64}}function b(k){const q=Math.floor(k/12)-1;return{name:E[k%12],octave:q}}function g(k){const q=k%12;return[1,3,6,8,10].includes(q)}function r(k){if(!e())return;const q=parseInt(k.currentTarget.dataset.note);e().playNote(q,100),m.set(q,k.currentTarget),k.currentTarget.classList.add("active"),z(o,!0)}function d(k){if(!e())return;const q=parseInt(k.currentTarget.dataset.note);e().stopNote(q),m.delete(q),k.currentTarget.classList.remove("active")}function T(k){if(!p(o)||!e())return;const q=parseInt(k.currentTarget.dataset.note);m.has(q)||(e().playNote(q,100),m.set(q,k.currentTarget),k.currentTarget.classList.add("active"))}function _(k){if(!p(o)||!e())return;const q=parseInt(k.currentTarget.dataset.note);m.has(q)&&(e().stopNote(q),m.delete(q),k.currentTarget.classList.remove("active"))}function u(k){if(!e())return;const q=k.key.toLowerCase(),R=y[q];if(R&&!k.repeat){e().playNote(R,100),m.set(R,document.querySelector(`[data-note="${R}"]`));const D=document.querySelector(`[data-note="${R}"]`);D&&D.classList.add("active")}}function t(k){if(!e())return;const q=k.key.toLowerCase(),R=y[q];if(R){e().stopNote(R),m.delete(R);const C=document.querySelector(`[data-note="${R}"]`);C&&C.classList.remove("active")}}function f(){e()&&(e().stopAll(),m.clear()),document.removeEventListener("keydown",u),document.removeEventListener("keyup",t)}Ve(()=>(document.addEventListener("keydown",u),document.addEventListener("keyup",t),f));function V(){const k=[];for(let q=0;q<l();q++)k.push(n()+q);return k}const N=V();var M=na(),I=A(M);Et(I,22,()=>N,k=>k,(k,q)=>{const R=Q(()=>g(q)),C=Q(()=>b(q)),D=Q(()=>`${p(C).name}${s()?p(C).octave:""}`);var G=aa();G.__mousedown=r,G.__mouseup=d,G.__touchstart=r,G.__touchend=d;let ae;var ce=A(G);{var ve=ee=>{var L=ta(),S=Ue(L),B=A(S,!0);w(S);var ne=x(S,2);{var me=re=>{var oe=ea(),Y=A(oe,!0);w(oe),j(()=>X(Y,p(C).octave)),U(re,oe)};te(ne,re=>{s()&&re(me)})}j(()=>X(B,p(C).name)),U(ee,L)};te(ce,ee=>{c()&&!p(R)&&ee(ve)})}w(G),j(()=>{H(G,"data-note",q),H(G,"title",`${p(D)} (MIDI ${q})`),H(G,"aria-label",`Piano key ${p(D)??""}`),ae=Be(G,1,"svelte-1xckpe",null,ae,{key,"white-key":!p(R),"black-key":p(R)})}),Me("mouseleave",G,_),Me("mouseenter",G,T),U(k,G)}),w(I),de(2),w(M),ke(M,k=>z(v,k),()=>p(v)),U(i,M),le()}ye(["mousedown","mouseup","touchstart","touchend"]);var oa=Ye('<svg class="knob-arc svelte-1prv3hj" viewBox="0 0 100 100"><path class="arc-background svelte-1prv3hj" d="M 50 8 A 42 42 0 0 1 78 78" stroke="var(--color-border)" stroke-width="2" fill="none" stroke-linecap="round"></path><path class="arc-active svelte-1prv3hj" d="M 50 8 A 42 42 0 0 1 78 78" stroke="var(--color-accent)" stroke-width="3" fill="none" stroke-linecap="round"></path></svg>'),ia=O('<div class="knob-container svelte-1prv3hj"><div class="knob-label svelte-1prv3hj"> </div> <button role="slider"><!> <div class="knob-grip svelte-1prv3hj"><div class="knob-indicator svelte-1prv3hj"></div></div></button> <div class="sr-only svelte-1prv3hj">Use arrow keys to adjust. Left/Right for coarse, Up/Down for fine control.</div></div>');function K(i,a){se(a,!0);let e=P(a,"value",15,.5),n=P(a,"min",3,0),l=P(a,"max",3,100),c=P(a,"step",3,1),s=P(a,"label",3,"Control"),v=P(a,"showIntensity",3,!0),o=P(a,"disabled",3,!1),m=P(a,"ariaLabel",19,s),y=P(a,"ariaDescribedBy",3,null),E=F(!1),h=F(null),b=F(null),g=Q(()=>(e()-n())/(l()-n())),r=Q(()=>p(g)*270),d=Q(()=>p(g));function T(L){return Math.max(0,Math.min(270,L))/270}function _(L,S){if(!p(h))return 0;const B=p(h).getBoundingClientRect(),ne=B.left+B.width/2,me=B.top+B.height/2,re=L-ne,oe=S-me;let Y=Math.atan2(oe,re)*(180/Math.PI);return Y=Y- -45,Y<0&&(Y+=360),Y}function u(L,S){const B=_(L,S),ne=T(B);e(Math.round((n()+ne*(l()-n()))/c())*c())}function t(L){o()||(z(E,!0),u(L.clientX,L.clientY),document.addEventListener("mousemove",f),document.addEventListener("mouseup",V))}function f(L){p(E)&&(L.preventDefault(),u(L.clientX,L.clientY))}function V(){z(E,!1),document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",V)}function N(L){if(o())return;let S=0;switch(L.key){case"ArrowUp":case"ArrowRight":S=c(),L.preventDefault();break;case"ArrowDown":case"ArrowLeft":S=-c(),L.preventDefault();break;default:return}e(Math.max(n(),Math.min(l(),e()+S)))}function M(L){if(o()||L.touches.length!==1)return;z(E,!0);const S=L.touches[0];u(S.clientX,S.clientY),document.addEventListener("touchmove",I),document.addEventListener("touchend",k)}function I(L){if(!p(E)||L.touches.length!==1)return;L.preventDefault();const S=L.touches[0];u(S.clientX,S.clientY)}function k(){z(E,!1),document.removeEventListener("touchmove",I),document.removeEventListener("touchend",k)}Z(()=>()=>{document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",V),document.removeEventListener("touchmove",I),document.removeEventListener("touchend",k)});var q=ia(),R=A(q),C=A(R,!0);w(R);var D=x(R,2);let G;D.__mousedown=t,D.__touchstart=M,D.__keydown=N;var ae=A(D);{var ce=L=>{var S=oa(),B=x(A(S));w(S),j(()=>Le(B,`stroke-dasharray: ${p(r)/270*220}px 220px; opacity: ${p(d)??""};`)),U(L,S)};te(ae,L=>{v()&&L(ce)})}var ve=x(ae,2);w(D),ke(D,L=>z(h,L),()=>p(h));var ee=x(D,2);w(q),ke(q,L=>z(b,L),()=>p(b)),j(L=>{X(C,s()),G=Be(D,1,"knob svelte-1prv3hj",null,G,{dragging:p(E),disabled:o()}),H(D,"aria-label",m()),H(D,"aria-describedby",y()),H(D,"aria-valuemin",n()),H(D,"aria-valuemax",l()),H(D,"aria-valuenow",e()),H(D,"aria-valuetext",L),H(D,"tabindex",o()?-1:0),Le(ve,`transform: rotate(${p(r)??""}deg);`),H(ee,"id",`${s()??""}-help`)},[()=>`${e().toFixed(2)}`]),U(i,q),le()}ye(["mousedown","touchstart","keydown"]);var sa=O('<div class="age-section svelte-1k9p173"><div class="age-header svelte-1k9p173"><h3 class="age-title svelte-1k9p173">AGE</h3> <div class="age-description svelte-1k9p173"> </div></div> <div class="age-knob-container svelte-1k9p173"><!></div> <div class="sr-only svelte-1k9p173" id="age-help">Adjust vintage character from pristine digital to heavily aged analog. Use arrow keys for fine control.</div></div>');function la(i,a){se(a,!0);let e=P(a,"ageAmount",15,0),n=Q(()=>e()===0?"Digital (pristine)":e()<25?"Subtle warmth":e()<50?"Warm vintage":e()<75?"Rich analog":"Heavily aged");Z(()=>{});var l=sa(),c=A(l),s=x(A(c),2),v=A(s,!0);w(s),w(c);var o=x(c,2),m=A(o);K(m,{min:0,max:100,step:1,label:"Vintage Character",showIntensity:!0,ariaLabel:"AGE - Analog Gear Emulation",ariaDescribedBy:"age-help",get value(){return e()},set value(y){e(y)}}),w(o),de(2),w(l),j(()=>X(v,p(n))),U(i,l),le()}var ca=O('<div class="room-section svelte-1903zij"><div class="room-header svelte-1903zij"><h3 class="room-title svelte-1903zij">Room Mics</h3> <div class="room-subtitle svelte-1903zij">Ambient Studio Character</div></div> <div class="room-controls svelte-1903zij"><div class="control-group svelte-1903zij"><!> <div class="control-info svelte-1903zij"> </div></div> <div class="control-group svelte-1903zij"><!> <div class="control-info svelte-1903zij"> </div></div></div> <div class="sr-only svelte-1903zij" id="mix-help">Adjust the balance between dry close-miked signal and ambient room reverb. Left is dry, right is full room.</div> <div class="sr-only svelte-1903zij" id="decay-help">Adjust how long the room reverb sustains. Left is short and tight, right is long and spacious.</div></div>');function ua(i,a){se(a,!0);let e=P(a,"roomMix",15,.3),n=P(a,"roomDecay",15,2),l=Q(()=>e()===0?"Dry (no room)":e()<.2?"Close (intimate)":e()<.4?"Balanced":e()<.7?"Ambient":"Lush (full room)"),c=Q(()=>n()<1?"Short (tight)":n()<2?"Medium (natural)":n()<3.5?"Long (spacious)":"Very long (cathedral)");Z(()=>{}),Z(()=>{});var s=ca(),v=x(A(s),2),o=A(v),m=A(o);K(m,{min:0,max:1,step:.05,label:"Mix",showIntensity:!0,ariaLabel:"Room Microphone Mix",ariaDescribedBy:"mix-help",get value(){return e()},set value(d){e(d)}});var y=x(m,2),E=A(y,!0);w(y),w(o);var h=x(o,2),b=A(h);K(b,{min:.5,max:5,step:.1,label:"Decay",showIntensity:!0,ariaLabel:"Room Reverb Decay Time",ariaDescribedBy:"decay-help",get value(){return n()},set value(d){n(d)}});var g=x(b,2),r=A(g,!0);w(g),w(h),w(v),de(4),w(s),j(()=>{X(E,p(l)),X(r,p(c))}),U(i,s),le()}var da=O('<div class="harmonic-indicator svelte-cu9oru"><div class="harmonic-bar svelte-cu9oru"></div></div>'),va=O('<div class="saturation-section svelte-cu9oru"><div class="saturation-header svelte-cu9oru"><h3 class="saturation-title svelte-cu9oru">Tube Saturation</h3> <div class="saturation-description svelte-cu9oru"> </div></div> <div class="saturation-knob-container svelte-cu9oru"><!></div> <!> <div class="sr-only svelte-cu9oru" id="saturation-help">Adjust tube saturation for warmth and harmonic richness. Increases from clean to heavily saturated.</div></div>');function ma(i,a){se(a,!0);let e=P(a,"saturation",15,0),n=Q(()=>Math.min(e()*2,100)),l=Q(()=>e()===0?"Clean (pristine)":e()<20?"Subtle warmth":e()<40?"Warm glow":e()<60?"Rich saturation":e()<80?"Heavy warmth":"Intense coloration");Z(()=>{});var c=va(),s=A(c),v=x(A(s),2),o=A(v,!0);w(v),w(s);var m=x(s,2),y=A(m);K(y,{min:0,max:100,step:1,label:"Warmth",showIntensity:!0,ariaLabel:"Tube Saturation - Warmth",ariaDescribedBy:"saturation-help",get value(){return e()},set value(b){e(b)}}),w(m);var E=x(m,2);{var h=b=>{var g=da(),r=A(g);w(g),j(()=>Le(r,`width: ${p(n)??""}%;`)),U(b,g)};te(E,b=>{e()>0&&b(h)})}de(2),w(c),j(()=>X(o,p(l))),U(i,c),le()}var fa=O('<div class="advanced-content svelte-1bdhmma"><div class="subsection svelte-1bdhmma"><h4 class="subsection-title svelte-1bdhmma">Envelope (ADSR)</h4> <div class="knob-grid svelte-1bdhmma"><div class="knob-item svelte-1bdhmma"><!></div> <div class="knob-item svelte-1bdhmma"><!></div> <div class="knob-item svelte-1bdhmma"><!></div> <div class="knob-item svelte-1bdhmma"><!></div></div></div> <div class="subsection svelte-1bdhmma"><h4 class="subsection-title svelte-1bdhmma">Compression</h4> <div class="knob-grid svelte-1bdhmma"><div class="knob-item svelte-1bdhmma"><!></div> <div class="knob-item svelte-1bdhmma"><!></div></div></div></div>'),ha=O('<div class="control-panel svelte-1bdhmma"><section class="control-section svelte-1bdhmma"><div class="section-header svelte-1bdhmma"><h3 class="section-title svelte-1bdhmma">Master Volume</h3></div> <div class="knob-container svelte-1bdhmma"><!></div></section> <!> <!> <!> <section class="control-section advanced-section svelte-1bdhmma"><button class="advanced-toggle svelte-1bdhmma"><span class="toggle-label svelte-1bdhmma"> </span></button> <!></section></div>');function ga(i,a){se(a,!0);let e=P(a,"audioState",3,void 0),n=F(ie(e()?.pianoState?.masterVolume??.5)),l=F(0),c=F(.3),s=F(2),v=F(0),o=F(!1),m=F(ie(e()?.synthesis?.attackTime??.05)),y=F(ie(e()?.synthesis?.decayTime??.2)),E=F(ie(e()?.synthesis?.sustainLevel??.6)),h=F(ie(e()?.synthesis?.releaseTime??1)),b=F(ie(e()?.effects?.compression?.threshold??-24)),g=F(ie(e()?.effects?.compression?.ratio??4));Z(()=>{e()&&e().setParameter("pianoState.masterVolume",p(n))}),Z(()=>{e()&&e().setParameter("effects.saturation.amount",p(v)/100)}),Z(()=>{e()&&(e().setParameter("effects.reverb.dryWet",p(c)),e().setParameter("effects.reverb.decayTime",p(s)))}),Z(()=>{e()&&p(o)&&(e().setParameter("synthesis.attackTime",p(m)),e().setParameter("synthesis.decayTime",p(y)),e().setParameter("synthesis.sustainLevel",p(E)),e().setParameter("synthesis.releaseTime",p(h)))}),Z(()=>{e()&&p(o)&&(e().setParameter("effects.compression.threshold",p(b)),e().setParameter("effects.compression.ratio",p(g)))});function r(){z(o,!p(o))}var d=ha(),T=A(d),_=x(A(T),2),u=A(_);K(u,{min:0,max:1,step:.05,label:"Level",showIntensity:!0,ariaLabel:"Master Volume",get value(){return p(n)},set value(C){z(n,C,!0)}}),w(_),w(T);var t=x(T,2);la(t,{get ageAmount(){return p(l)},set ageAmount(C){z(l,C,!0)}});var f=x(t,2);ua(f,{get roomMix(){return p(c)},set roomMix(C){z(c,C,!0)},get roomDecay(){return p(s)},set roomDecay(C){z(s,C,!0)}});var V=x(f,2);ma(V,{get saturation(){return p(v)},set saturation(C){z(v,C,!0)}});var N=x(V,2),M=A(N);M.__click=r;var I=A(M),k=A(I);w(I),w(M);var q=x(M,2);{var R=C=>{var D=fa(),G=A(D),ae=x(A(G),2),ce=A(ae),ve=A(ce);K(ve,{min:0,max:.5,step:.01,label:"Attack",ariaLabel:"Attack Time",get value(){return p(m)},set value(W){z(m,W,!0)}}),w(ce);var ee=x(ce,2),L=A(ee);K(L,{min:0,max:1,step:.01,label:"Decay",ariaLabel:"Decay Time",get value(){return p(y)},set value(W){z(y,W,!0)}}),w(ee);var S=x(ee,2),B=A(S);K(B,{min:0,max:1,step:.05,label:"Sustain",ariaLabel:"Sustain Level",get value(){return p(E)},set value(W){z(E,W,!0)}}),w(S);var ne=x(S,2),me=A(ne);K(me,{min:0,max:3,step:.05,label:"Release",ariaLabel:"Release Time",get value(){return p(h)},set value(W){z(h,W,!0)}}),w(ne),w(ae),w(G);var re=x(G,2),oe=x(A(re),2),Y=A(oe),$e=A(Y);K($e,{min:-60,max:0,step:1,label:"Threshold",ariaLabel:"Compression Threshold",get value(){return p(b)},set value(W){z(b,W,!0)}}),w(Y);var xe=x(Y,2),je=A(xe);K(je,{min:1,max:20,step:.5,label:"Ratio",ariaLabel:"Compression Ratio",get value(){return p(g)},set value(W){z(g,W,!0)}}),w(xe),w(oe),w(re),w(D),U(C,D)};te(q,C=>{p(o)&&C(R)})}w(N),w(d),j(()=>X(k,`${p(o)?"‚ñº":"‚ñ∂"} Advanced Controls`)),U(i,d),le()}ye(["click"]);var pa=O('<div class="status-bar svelte-qgpshq"><span class="status-indicator active svelte-qgpshq">‚óè Live</span> <span class="note-count svelte-qgpshq"> </span> <button class="toggle-btn svelte-qgpshq"> </button></div>'),ya=O('<div class="error-state svelte-qgpshq"><p class="error-icon svelte-qgpshq">‚ö†Ô∏è</p> <h2 class="svelte-qgpshq">Audio Initialization Failed</h2> <p class="error-message svelte-qgpshq"> </p> <p class="error-help svelte-qgpshq">Try refreshing the page or check browser console for details.</p></div>'),Ta=O('<div class="controls-section svelte-qgpshq"><!></div>'),ba=O('<div class="content svelte-qgpshq"><!> <div class="keyboard-section svelte-qgpshq"><!></div> <div class="info-section svelte-qgpshq"><div class="info-card svelte-qgpshq"><h3 class="svelte-qgpshq">üéµ Getting Started</h3> <ul class="svelte-qgpshq"><li class="svelte-qgpshq">Click piano keys to play notes</li> <li class="svelte-qgpshq">Use QWERTY keys (Z-M) for keyboard playing</li> <li class="svelte-qgpshq">Adjust controls above to shape your sound</li> <li class="svelte-qgpshq">Drag across keys for glissando effect</li></ul></div> <div class="info-card svelte-qgpshq"><h3 class="svelte-qgpshq">üéõÔ∏è Quick Tips</h3> <ul class="svelte-qgpshq"><li class="svelte-qgpshq"><strong class="svelte-qgpshq">Saturation:</strong> Adds warm, tape-like color</li> <li class="svelte-qgpshq"><strong class="svelte-qgpshq">Compression:</strong> Controls dynamics</li> <li class="svelte-qgpshq"><strong class="svelte-qgpshq">Reverb:</strong> Adds space and ambience</li> <li class="svelte-qgpshq"><strong class="svelte-qgpshq">Envelope:</strong> Shapes note attack and decay</li></ul></div></div></div>'),_a=O('<div class="loading svelte-qgpshq"><div class="spinner svelte-qgpshq"></div> <p class="svelte-qgpshq">Initializing audio system...</p> <p class="loading-hint svelte-qgpshq">Click anywhere to unlock audio (iOS/mobile)</p></div>'),Ea=O('<main class="svelte-qgpshq"><div class="container svelte-qgpshq"><div class="header svelte-qgpshq"><h1 class="svelte-qgpshq">üéπ LoFi Piano</h1> <p class="subtitle svelte-qgpshq">Nostalgic warm piano for lo-fi hip-hop beats</p> <!></div> <!></div></main>');function wa(i,a){se(a,!0);const e=Jt();let n=F(!1),l=F(null),c=F(!0);Ve(async()=>{try{await Rt(),await e.init(),z(n,!0),console.log("‚úì LoFi Piano initialized"),console.log("  - Audio context ready"),console.log("  - Effect chain connected"),console.log("  - Ready to play")}catch(r){console.error("Failed to initialize audio:",r),z(l,r.message,!0)}});function s(){z(c,!p(c))}var v=Ea(),o=A(v),m=A(o),y=x(A(m),4);{var E=r=>{var d=pa(),T=x(A(d),2),_=A(T);w(T);var u=x(T,2);u.__click=s;var t=A(u,!0);w(u),w(d),j(()=>{X(_,`${e.pianoState.activeNotes.size??""} notes playing`),X(t,p(c)?"‚ñº Hide Controls":"‚ñ∂ Show Controls")}),U(r,d)};te(y,r=>{p(n)&&r(E)})}w(m);var h=x(m,2);{var b=r=>{var d=ya(),T=x(A(d),4),_=A(T,!0);w(T),de(2),w(d),j(()=>X(_,p(l))),U(r,d)},g=r=>{var d=We(),T=Ue(d);{var _=t=>{var f=ba(),V=A(f);{var N=k=>{var q=Ta(),R=A(q);ga(R,{get audioState(){return e}}),w(q),U(k,q)};te(V,k=>{p(c)&&k(N)})}var M=x(V,2),I=A(M);ra(I,{get audioState(){return e}}),w(M),de(2),w(f),U(t,f)},u=t=>{var f=_a();U(t,f)};te(T,t=>{p(n)?t(_):t(u,!1)},!0)}U(r,d)};te(h,r=>{p(l)?r(b):r(g,!1)})}w(o),w(v),U(i,v),le()}ye(["click"]);function Da(i,a){se(a,!1),Ve(()=>{console.log("üéπ LoFi Piano loaded")}),bt(),wa(i,{}),le()}export{Da as component};
//# sourceMappingURL=2.B5q-dv_d.js.map
